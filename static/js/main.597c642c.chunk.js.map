{"version":3,"sources":["i18n/i18n.js","utils/OrderbookParser.js","actions/modal.js","constants/actionTypesUser.js","constants/languageType.js","constants/actionTypesBook.js","utils/rpc.js","constants/actionTypesNews.js","components/tokenList/tokenList.js","store/configureStore.js","components/header/header.js","utils/format.js","constants/actionTypeMortgage.js","reducers/book.js","reducers/user.js","reducers/modal.js","reducers/news.js","reducers/mortgage.js","reducers/index.js","epics/book.js","epics/user.js","epics/index.js","store/configureStore.prod.js","components/main/main.js","utils/asyncComponent.js","App.js","routes/routes.js","index.js","actions/user.js","constants/actionTypesModal.js","actions/book.js"],"names":["options","order","lookupQuerystring","lookupCookie","lookupLocalStorage","lookupFromPathIndex","lookupFromSubdomainIndex","caches","excludeCacheFor","cookieMinutes","cookieDomain","htmlTag","document","documentElement","lngDetector","LanguageDetector","i18n","use","XHR","init","whitelist","fallbackLng","ns","defaultNS","debug","interpolation","escapeValue","load","lowerCaseLng","backend","loadPath","detection","END_RESULT","padEnd","OrdernookParser","web3","contractAddress","this","_web3","_contract","from","to","price","Promise","resolve","reject","data","padStart","eth","call","error","result","books","address","_result","replace","console","log","_amount","substr","_next","push","fromAmount","fromToken","toToken","user","filled","_getOrderBooks","_getNextOrderPrice","then","_getAll","catch","e","_from","_to","_orders","key","cacheBooks","filter","r","updateLoading","type","types","updateMessage","ACCOUNT_GET$","ACCOUNT_UPDATE","MYBOOKS_GET$","MYBOOKS_UPDATE","MYBOOKS_ADD","MYBOOKS_CANCEL","MYBOOKS_CHANGE","USER_GET$","USER_UPDATE","HISTORY_GET$","HISTORY_UPDATE","MYTRANSACTION_CHANGE","MYTRANSACTION_UPDATE","KEEP","DOWNLOADED","language","name","FROM_CHANGE","TO_CHANGE","BOOK_GET$","BOOK_UPDATE","TOKENLIST_GET","SUMMARY_GET$","SUMMARY_UPDATE","TRADELIST_GET","RECENTTRANSACTION_GET$","RECENTTRANSACTION_UPDATE","KLINE_GET$","KLINE_UPDATE","TIMEUINT_CHANGE","xpaExchange","finalConfig","serverUrl","richAddress","ethAddress","XPAAsset","XPA","parser","createElement","href","minGasPrice","cash","assetToken","provider","Web3","providers","HttpProvider","useExtension","OrderbookParser","setExtensionAddress","callback","getAccounts","err","accs","defaultAccount","length","window","location","reload","startExtension","login","ethereum","removeAllListeners","on","accounts","enable","setWeb3Provider","Date","now","headers","value","echashcash","pathname","setProvider","sha3","str","utils","zero","l","rs","Array","fill","join","calAmount","amount","decimal","BN","test","tenFill","toString","ecRequest","Url","hash","xhr","XMLHttpRequest","url","open","onreadystatechange","readyState","DONE","response","onerror","status","statusText","hashcash","setRequestHeader","send","JSON","stringify","checkReceipt","param","func","getTransactionReceipt","res","jsonrpc","method","params","id","parse","reduce","prev","blockNumber","setTimeout","getNonce","a","getTransactionCount","bnTen","getDecimal","token","Number","getAllowance","userAddress","contract","getGasPrice","getUserBalance","array","body","promises","forEach","getBalance","balanceHex","all","balances","map","d","subHex","getGasLimit","retry","estimateGas","sendRawTransaction","nonce","gasPrice","gasLimit","sendTransaction","bnHex","gas","privateKey","ethereumjs","Buffer","txParams","chainId","tx","Tx","sign","serializedTx","serialize","calcFee","fee","agent","fromDecimal","toDecimal","n","g","des","num","ap","approve","observerAllowance","allowance","observerApprove","eciban","toIBAN","observerEstimatGas","transaction","receipt","_receipt","parseInt","limit","createStream","raw","estimateCancel","cancelOrder","cancelStream","showMeMoney","testAddress","getMortgageRate","getHighestMortgageRate","getUsableXPA","getClosingLine","getMortgagePrice","Object","keys","rejex","i","getEquvialentAmount","getAmount","withdrawFee","offsetFee","estimateMortgage","mortgage","allow","estimateAct","doAct","estimateOffset","doOffset","mailTo","SET_NEWS","TokenList","props","state","base","favorite","localStorage","getItem","favoriteToggle","bind","handleClick","t","basic","tokenList","find","setState","update","$set","item","stopPropagation","indexOf","$push","setItem","addressId","val","target","list","tradeList","select","listArray","searchStyle","favoriteData","toLowerCase","isFavorite","fav","baseAddress","onClick","className","aria-hidden","formatNumber","latest","String","growth","k","changeToken","onChange","src","alt","renderMenu","React","Component","defaultProps","translate","module","exports","require","Header","withRouter","lang","menu","showMenu","showList","showContract","changeHeader","renderLanguage","renderSummary","renderContract","closeList","dash","addEventListener","nextProp","nextState","removeEventListener","lan","tar","changeLanguage","contains","desc","obj","myTransaction","actions","userActions","myTransactionChange","able","total","act","ref","el","contractBtn","onMouseEnter","onMouseLeave","match","path","summary","max","min","renderList","production","guide","accMul","arg1","arg2","m","s1","s2","split","float","int","maxFloatLen","de","parseFloat","Math","floor","toFixed","warn","formatTime","timestamp","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","isFloat","times","num1","num2","dot1","dot2","Num1","Num2","fixedFloor","scnToStr","x","abs","substring","input","index","idx","tmpArr","l1","l2","sellAmount","fAmount","fFill","fDecimal","sub","sellDisplayPrice","tDecimal","buyAmount","mul","buyDisplayPrice","div","CHANGE_MORTGAGE_RATE","CHANGE_EQUIVALENT_AMOUNT","CHANGE_USABLE","CHANGE_LOAN","CHANGE_REMAINING","CHANGE_USABLE_XPA","MORTGAGE_LOGOUT","CHANGE_MORTGAGE_PRICE","initialState","buy","sell","kLine","timeunit","account","myBooks","keep","myHistory","loading","message","mortgageRate","equivalentAmount","usable","loan","remaining","closingLine","usableXPA","rootReducer","combineReducers","book","action","$unshift","cancel","modal","news","action$","state$","pipe","ofType","switchMap","Rxfrom","getAll","concatMap","orders","tk","arrenge","sort","b","gt","curr","add","v","displayPrice","undefined","reverse","of","mergeMap","bookUpdate","catchError","obs","concat","arr","values","recentTransactionUpdate","getTime","kLineGet$","final","summaryUpdate","lt","timeParse","dbObj","once","snapshot","startday","data5ma","data10ma","initialData","high","low","close","kLineData","tmpFrom","tmpTo","j","p","previ","kLineUpdate","userUpdate","accountGet$","myBooksGet$","wallet","rpc","accountUpdate","orderByChild","equalTo","displayAmount","no","myBooksUpdate","historyUpdate","rootEpic","combineEpics","booksEpic","userEpic","epicMiddleware","createEpicMiddleware","configureStore","middleware","store","createStore","compose","applyMiddleware","thunk","devToolsExtension","f","run","Main","context","children","contextTypes","router","PropTypes","object","isRequired","asyncComponent","getComponent","mounted","AsyncComponent","query","search","routes","exact","component","default","nomatch","render","App","history","createBrowserHistory","routerMiddleware","ReactDOM","getElementById","userGet$","myBooksAdd","myBooksCancel","myBooksChange","myTransactionUpdate","historyGet$","changeKeep","UPDATE_LOADING","UPDATE_MESSAGE","changeFrom","changeTo","bookGet$","tokenListGet","summaryGet$","tradeListGet","recentTransactionGet$","timeunitChange"],"mappings":"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","file":"static/js/main.597c642c.chunk.js","sourcesContent":["import i18n from 'i18next';\nimport XHR from 'i18next-xhr-backend';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\nconst options = {\n    // order and from where user language should be detected\n    order: ['querystring', 'cookie', 'localStorage', 'navigator', 'htmlTag', 'path', 'subdomain'],\n\n    // keys or params to lookup language from\n    lookupQuerystring: 'lng',\n    lookupCookie: 'i18next',\n    lookupLocalStorage: 'i18nextLng',\n    lookupFromPathIndex: 0,\n    lookupFromSubdomainIndex: 0,\n\n    // cache user language on\n    caches: ['localStorage', 'cookie'],\n    excludeCacheFor: ['cimode'], // languages to not persist (cookie, localStorage)\n\n    // optional expire and domain for set cookie\n    cookieMinutes: 10,\n    cookieDomain: 'myDomain',\n\n    // optional htmlTag with lang attribute, the default is:\n    htmlTag: document.documentElement\n};\n\nconst lngDetector = new LanguageDetector(null, options);\n\ni18n.use(XHR)\n    .use(lngDetector)\n    .init({\n        whitelist: [\n            'en-us', 'zh-tw', 'zh-cn', 'ko-kr', 'ja-jp'\n        ],\n\n        fallbackLng: 'en-us', // \n\n        ns: ['common'], //  loading namespace  common.js\n\n        defaultNS: 'common', //  namespace name\n\n        debug: false,\n\n        interpolation: {\n            escapeValue: false // not needed for react!!\n        },\n\n        load: 'currentOnly',\n\n        lowerCaseLng: true,\n\n        backend: {\n            //  server , GET server \n            // lng =  ns = namespace\n            loadPath: '/locales/{{lng}}/{{ns}}.json'\n        },\n\n        detection: {\n            lookupLocalStorage: 'i18nextLng'\n        },\n\n    });\n\nexport default i18n;\n","const END_RESULT = ''.padEnd(64, '0');\nclass OrdernookParser {\n    static _web3;\n    static _contract;\n\n    static init(web3, contractAddress) {\n        this._web3 = web3;\n        this._contract = contractAddress;\n    }\n\n    static cacheBooks = {}\n\n    // getPriceBooks(from, to, price = '0') {\n    //     web3.eth.call({\n    //         to: this._contract,\n    //         data: \"0xc6888fa10000000000000000000000000000000000000000000000000000000000000003\"\n    //     }).then(console.log);\n    // }\n\n    /**\n     * Get next order price\n     * @param  {String} from     The Ethereum address\n     * @param  {String} to       The Ethereum address\n     * @param  {String} price    The previous price\n     * @returns {Promise<String>}          The next price, if not 0 => has next price\n    */\n    static _getNextOrderPrice(from, to, price = '0') {\n        return new Promise((resolve, reject) => {\n            const data = `0x3c39e63c${from.padStart(64, '0')}${to.padStart(64, '0')}${price.padStart(64, '0')}`;\n            \n            web3.eth.call({\n                to: this._contract,\n                data\n            }, (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(result);\n                }\n            });\n\n        });\n    }\n\n    /**\n     * Get order books\n     * @param  {String} from     The Ethereum address\n     * @param  {String} to       The Ethereum address\n     * @param  {String} price    Return value from this.getNextOrderBooks\n     * @param  {Array} books     The order books\n     *  @param  {String} address  The Ethereum address\n     * @returns {Promise}        \n    */\n    static _getOrderBooks(from, to, price, books, address = '0') {\n        return new Promise((resolve, reject) => {\n            const data = `0x66abbcbd${from.padStart(64, '0')}${to.padStart(64, '0')}${price.padStart(64, '0')}${address.padStart(64, '0')}`;\n\n            this._web3.eth.call({\n                to: this._contract,\n                data,\n            }, (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    const _result = result.replace('0x', '');\n                    console.log(_result)\n                    const _amount = _result.substr(0, 64);\n                    const _next = _result.substr(64, 64);\n                    console.log('Address: ', address);\n\n                    console.log('Get Amount ', _amount);\n                    console.log('Get Next ', _next);\n\n                    if (address !== END_RESULT) {\n                        books.push({\n                            fromAmount: _amount,\n                            price,\n                            fromToken: `0x${from}`,\n                            toToken: `0x${to}`,\n                            user: `0x${address}`,\n                            filled: '0' // TODO: \n                        })\n                    }\n\n                    if (_next !== END_RESULT || (address !== END_RESULT && _next !== END_RESULT)) {\n                        resolve(this._getOrderBooks(from, to, price, books, _next));\n                    } else {\n                        resolve(price);\n                    }\n                }\n            });\n\n        })\n    }\n\n    /**\n     * Get orders\n     * @param  {String} from     The Ethereum address\n     * @param  {String} to       The Ethereum address\n     * @param  {String} price    Return value from this.getNextOrderBooks\n     * @param  {Array} books     The order books\n     * @returns {Promise}        \n    */\n    static _getAll(from, to, books, price = '0') {\n        return new Promise((resolve, reject) => {\n\n            this._getNextOrderPrice(from, to, price)\n            .then((price) => {\n                console.log('getNextOrderPrice: ', price);\n                return this._getOrderBooks(from, to, price.replace('0x', ''), books)\n            }).then((price) => {\n                console.log(books);\n                if (price !== END_RESULT) {\n                    resolve(this._getAll(from, to, books, price))\n                } else {\n                    resolve(books)\n                }\n            })\n            .catch((e) => {\n                reject(e);\n            });\n        });\n    }\n\n    /**\n     * @param {String} from     The Ethereum address\n     * @param {String} to       The Ethereum address\n     * @returns {Promise}\n    */\n    static getAll(from, to) {\n        const _from = from.replace('0x', '');\n        const _to = to.replace('0x', '');\n        const _orders = [];\n\n        return new Promise((resolve, reject) => {\n            const key = _from + _to;\n            if (this.cacheBooks[key]) return resolve(this.cacheBooks[key]);\n\n            this._getAll(_from, _to, _orders).then((result) => {\n                console.log(result);\n                const _result = result.filter(r => r.fromAmount !== END_RESULT)\n                this.cacheBooks[key] = _result;\n                resolve(_result);\n            }).catch((e) => {\n                reject(e);\n            })\n        });\n    }\n}\n\nexport default OrdernookParser;\n","import * as types from '../constants/actionTypesModal';\n\nexport function updateLoading(data)\n{\n    return {\n        type: types.UPDATE_LOADING,\n        data\n    };\n}\n\nexport function updateMessage(data)\n{\n    return {\n        type: types.UPDATE_MESSAGE,\n        data\n    };\n}\n","export const ACCOUNT_GET$ = 'ACCOUNT_GET$';\nexport const ACCOUNT_UPDATE = 'ACCOUNT_UPDATE';\nexport const MYBOOKS_GET$ = 'MYBOOKS_GET$';\nexport const MYBOOKS_UPDATE = 'MYBOOKS_UPDATE';\nexport const MYBOOKS_ADD = 'MYBOOKS_ADD';\nexport const MYBOOKS_CANCEL = 'MYBOOKS_CANCEL';\nexport const MYBOOKS_CHANGE = 'MYBOOKS_CHANGE';\nexport const USER_GET$ = 'USER_GET$';\nexport const USER_UPDATE = 'USER_UPDATE';\nexport const HISTORY_GET$ = 'HISTORY_GET$';\nexport const HISTORY_UPDATE = 'HISTORY_UPDATE';\nexport const MYTRANSACTION_CHANGE = 'MYTRANSACTION_CHANGE';\nexport const MYTRANSACTION_UPDATE = 'MYTRANSACTION_UPDATE';\nexport const KEEP = 'KEEP';\nexport const DOWNLOADED = 'DOWNLOADED';\nexport const CHANGE_HREF = 'CHANGE_HREF';\n\n","export const language = [\n    { type: '', name: 'zh-tw' },\n    { type: '', name: 'zh-cn' },\n    { type: 'English', name: 'en-us' },\n    { type: '', name: 'ko-kr' },\n    { type: '', name: 'ja-jp' }\n];\n","export const FROM_CHANGE = 'FROM_CHANGE';\nexport const TO_CHANGE = 'TO_CHANGE';\nexport const BOOK_GET$ = 'BOOK_GET$';\nexport const BOOK_UPDATE = 'BOOK_UPDATE';\nexport const TOKENLIST_GET = 'TOKENLIST_GET';\nexport const SUMMARY_GET$ = 'SUMMARY_GET$';\nexport const SUMMARY_UPDATE = 'SUMMARY_UPDATE';\nexport const TRADELIST_GET = 'TRADELIST_GET';\nexport const RECENTTRANSACTION_GET$ = 'RECENTTRANSACTION_GET$';\nexport const RECENTTRANSACTION_UPDATE = 'RECENTTRANSACTION_UPDATE';\nexport const KLINE_GET$ = 'KLINE_GET$';\nexport const KLINE_UPDATE = 'KLINE_UPDATE';\nexport const TIMEUINT_CHANGE = 'TIMEUINT_CHANGE';\n","/* eslint-disable no-undef */\nimport Web3 from 'web3';\nimport { subHex, tenFill, bnHex, bnTen } from './format';\nimport OrderbookParser from './OrderbookParser';\n\nconst xpaExchange = finalConfig.xpaExchange;\nconst serverUrl = finalConfig.serverUrl;\nconst richAddress = '0xa8b8057f02e1d21ccf5707a1d18747a3976c119a';\nconst ethAddress = finalConfig.ethAddress;\nconst XPAAsset = finalConfig.XPAAsset;\n\nconst XPA = finalConfig.XPA;\n\nconst parser = document.createElement('a');\nparser.href = serverUrl;\n// const hashcash = echashcash(parser.pathname);\n\nconst approveGasLimit = '0xc350';\nconst minGasPrice = '0x02540be400';\nconst cash = { ...finalConfig.assetToken, XPA };\nconst provider = new Web3.providers.HttpProvider(serverUrl);\n\nlet timestamp = null;\nlet useExtension = false;\nlet web3 = new Web3(provider);\n\nOrderbookParser.init(web3, xpaExchange);\n\nconst ethEnabled = () => {\n    if (window.ethereum) {\n        window.web3 = new Web3(window.ethereum);\n        window.ethereum.enable();\n        return true;\n    }\n    return false;\n}\n\nexport const setExtensionAddress = (callback) => {\n    web3.eth.getAccounts((err, accs) => {\n        if (typeof callback === 'function' && accs[0]) {\n            web3.eth.defaultAccount = accs[0];\n            if (accs.length === 0) return window.location.reload();\n            callback(accs[0].replace('0x', ''));\n        }\n    });\n}\n\nexport const startExtension = (login) => {\n    window.ethereum.removeAllListeners();\n    window.ethereum.on('accountsChanged', function (accounts) {\n        if (typeof login === 'function' && accounts.length > 0) {\n            login(accounts[0].replace('0x', ''));\n        }\n    });\n    if (ethEnabled()) {\n        web3 = window.web3;\n        useExtension = true;\n    }\n    return;\n    \n}\n\n\nexport const setWeb3Provider = () => {\n    if (useExtension) return;\n    // if (!timestamp || Date.now() - timestamp > 10 * 1000)\n    // {    \n    timestamp = Date.now();\n    provider.headers = [{ name: 'hashcash', value: echashcash(parser.pathname) }];\n    web3.setProvider(provider);\n    // }\n};\n\nconst sha3 = (str) => {\n    return Web3.utils.sha3(str);\n};\n\n\n/**\n *  l \n * @param  {[String]} str [String]\n * @param  {[type]} l   [number]\n * @return {[type]}     [String]\n */\nfunction zero(str, l) {\n    let rs = str;\n    if (str.length < l) {\n        rs = new Array(l - str.length).fill(0).join('') + rs;\n    }\n    return rs;\n}\n\n/**\n *  arraybuffer \n * @param  {[type]} arrayBuffer []\n * @return {[type]}            [String]\n */\n// function arrayBufferToHex(arrayBuffer)\n// {\n//     if (typeof arrayBuffer !== 'object' || arrayBuffer === null || typeof arrayBuffer.byteLength !== 'number')\n//     {\n//         throw new TypeError('Expected input to be an ArrayBuffer');\n//     }\n//     let view = new Uint8Array(arrayBuffer);\n//     let result = '';\n//     let value;\n//     for (let i = 0; i < view.length; i += 1)\n//     {\n//         value = view[i].toString(16);\n//         result += (value.length === 1 ? `0${value}` : value);\n//     }\n//     return result;\n// }\n\n/**\n * 16\n * @param  {[string]} amount []\n * @param  {[string]} amount []\n * @param  {[number]} decial []\n * @return {[number]}\n */\nfunction calAmount(amount, decimal) {\n    const BN = Web3.utils.BN;\n    if (/0x/.test(amount)) {\n        return amount.replace('0x', '');\n    }\n    else {\n        return new BN(tenFill(amount, decimal)).toString(16);\n    }\n}\n\n/**\n * []\n * @param  {[type]} data [params => object]\n * @return {[type]}      [promise]\n */\nfunction ecRequest(data, Url, hash) {\n    return new Promise((resolve, reject) => {\n        const xhr = new XMLHttpRequest();\n        const url = Url || serverUrl;\n        const method = 'POST';\n        xhr.open(method, url);\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState === XMLHttpRequest.DONE) {\n                resolve(xhr.response);\n            }\n        };\n        xhr.onerror = () => {\n            reject({\n                status: this.status,\n                statusText: xhr.statusText\n            });\n        };\n\n        const hashcash = echashcash(parser.pathname);\n        xhr.setRequestHeader('Content-Type', 'application/json');\n        xhr.setRequestHeader('hashcash', hash || hashcash);\n        xhr.send(JSON.stringify(data));\n    });\n}\n\nconst checkReceipt = (param) => {\n    const retry = 50;\n    const wait = 7000;\n\n    const func = useExtension ? () => new Promise((resolve, reject) => {\n        web3.eth.getTransactionReceipt(param, (error, res) => {\n            console.log('Error: '. error);\n            console.log('Result: '. res);\n            if (error) return resolve();\n            resolve(res);\n        })\n    }) : () => new Promise((resolve, reject) => {\n        const data = {\n            jsonrpc: '2.0',\n            method: 'eth_getTransactionReceipt',\n            params: [param],\n            id: 7\n        };\n        ecRequest(data).then((res) => {\n            const result = JSON.parse(res);\n            resolve(result);\n        })\n    })\n\n\n    console.log('check receipt ******************', param);\n\n    return new Array(retry).fill(0).reduce((prev) => {\n        return prev.then((rs) => {\n            if (rs) {\n                return Promise.resolve(rs);\n            }\n            else {\n                return func().then((res) => {\n                    \n                    if ( res === null || res.error || !(res.blockNumber > 0)) {\n                        console.log(`re check receipt ${res}`);\n                        return new Promise((resolve) => {\n                            setTimeout(() => {\n                                resolve();\n                            }, wait);\n                        });\n                    }\n                    else {\n                        return Promise.resolve(res);\n                    }\n                });\n            }\n        });\n    }, Promise.resolve());\n};\n\n/**\n * [ user addres nonce = > ]\n * @param  {[type]} address [description]\n * @return {[type]}         [description]\n */\nasync function getNonce(address) {\n    // const number = await web3.eth.getTransactionCount(`0x${address}`, 'pending');\n    // return Promise.resolve(`0x${number.toString(16)}`);\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.getTransactionCount(`0x${address}`, (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    console.log('Nonce: ', result)\n                    resolve('0x' + bnTen(result).toString(16));\n                }\n            })\n        })\n    } else {\n        const params = [`0x${address}`, 'latest'];\n        const data = {\n            jsonrpc: '2.0',\n            method: 'eth_getTransactionCount',\n            params,\n            id: 7\n        };\n        return ecRequest(data).then((res) => {\n\n            return Promise.resolve(JSON.parse(res).result);\n        });\n    }\n}\n\n/**\n * [token]\n * @param  {[type]} token [object => { ...rest }]\n * @return {[type]}       [description]\n */\nexport function getDecimal(token) {\n    if (token.address === ethAddress) {\n        return Promise.resolve(18);\n    }\n    else {\n        const data = `${sha3('decimals()').substr(0, 10)}000000000000000000000000`;\n        if (useExtension) {\n\n            return new Promise((resolve, reject) => {\n                web3.eth.call({\n                    to: token.address,\n                    data\n                }, (error, result) => {\n                    if (error) {\n                        reject(error);\n                    } else {\n                        resolve(Number(result));\n                    }\n                })\n            })\n        } else {\n            const param = {\n                jsonrpc: '2.0',\n                method: 'eth_call',\n                params: [{\n                    to: token.address,\n                    data,\n                }, 'latest'],\n                id: 7\n            };\n            return new Promise((resolve, reject) => {\n                ecRequest(param).then((res) => {\n                    try {\n                        resolve(JSON.parse(res).result);\n                    } catch (e) {\n                        reject(e);\n                    }\n                })\n            })\n\n        }\n    }\n}\n\nfunction getAllowance(userAddress, token, contract) {\n    const data = `${sha3('allowance(address,address)').substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}${zero(contract.replace('0x', ''), 64)}`;\n\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.call({\n                to: token.address,\n                data\n            }, (error, result) => {\n                console.log(error, result);\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(result);\n                }\n            })\n        })\n    } else {\n        const param = {\n            jsonrpc: '2.0',\n            method: 'eth_call',\n            params: [{\n                to: token.address,\n                data,\n            }, 'latest'],\n            id: 7\n        };\n        return new Promise((resolve, reject) => {\n            ecRequest(param).then((res) => {\n                try {\n                    resolve(JSON.parse(res).result);\n                }\n                catch (e) {\n                    reject(e);\n                }\n            })\n\n        })\n    }\n}\n\n/**\n * [ gas ]\n * @return {[type]} [description]\n */\nexport function getGasPrice() {\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.getGasPrice((error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    console.log('Gas Price:', result);\n                    resolve('0x' + bnTen(result).toString(16));\n                }\n            })\n        })\n    } else {\n        const data = {\n            jsonrpc: '2.0',\n            method: 'eth_gasPrice',\n            params: [],\n            id: 7\n        };\n        return new Promise((resolve, reject) => {\n            ecRequest(data).then(res => {\n                try {\n                    resolve(JSON.parse(res).result);\n                } catch(e) {\n                    reject(e);\n                }\n            })\n        })\n    }\n\n}\n\nexport function getUserBalance(array, address) {\n    const body = [];\n\n    if (useExtension) {\n        const promises = [];\n        array.forEach((token) => {\n            if (token.address === ethAddress) {\n                promises.push(\n                    new Promise((resolve, reject) => {\n                        web3.eth.getBalance(address, (error, result) => {\n                            if (error) {\n                                reject(error);\n                            } else {\n                                const balanceHex = bnTen(result).toString(16);\n\n                                resolve(balanceHex);\n                            }\n                        })\n                    })\n                )\n            } else {\n                promises.push(\n                    new Promise((resolve, reject) => {\n                        web3.eth.call({\n                            to: token.address,\n                            data: `${sha3('balanceOf(address)').substr(0, 10)}000000000000000000000000${address}`\n                        }, (error, result) => {\n                            if (error) {\n                                reject(error);\n                            } else {\n                                resolve(result.replace('0x', ''))\n                            }\n                        })\n                    })\n\n                )\n            }\n        })\n        return Promise.all(promises);\n    } else {\n\n        array.forEach((token) => {\n            if (token.address === ethAddress) {\n                const data = {\n                    jsonrpc: '2.0',\n                    method: 'eth_getBalance',\n                    params: [`0x${address}`, 'latest'],\n                    id: 7\n                };\n                body.push(data);\n            }\n            else {\n                const data = {\n                    jsonrpc: '2.0',\n                    method: 'eth_call',\n                    params: [{\n                        data: `${sha3('balanceOf(address)').substr(0, 10)}000000000000000000000000${address}`,\n                        to: token.address,\n                    }, 'latest'],\n                    id: 7\n                };\n                body.push(data);\n            }\n        });\n\n        return new Promise((resolve, reject) => {\n            return ecRequest(body).then((res) => {\n                try {\n                    const balances = JSON.parse(res).map(d => subHex(d.result));\n                    resolve(balances);\n\n                } catch (e) {\n                    reject(e);\n                }\n\n            })\n        })\n\n    }\n}\n\n\n// UNNECESSARY\n/**\n * [ user  token ]\n * @param  {[type]} array   [token array]\n * @param  {[type]} address [user address]\n * @return {[type]}         [description]\n */\nexport function getUserPendingBalance(array, address) {\n    const body = [];\n    array.forEach((token) => {\n        if (token.address === ethAddress) {\n            const data = {\n                jsonrpc: '2.0',\n                method: 'eth_getBalance',\n                params: [`0x${address}`, 'pending'],\n                id: 7\n            };\n            body.push(data);\n        }\n        else {\n            const data = {\n                jsonrpc: '2.0',\n                method: 'eth_call',\n                params: [{\n                    data: `${sha3('balanceOf(address)').substr(0, 10)}000000000000000000000000${address}`,\n                    to: token.address,\n                }, 'pending'],\n                id: 7\n            };\n\n            body.push(data);\n        }\n    });\n    return ecRequest(body);\n}\n\n/**\n * [ gas limit]\n * @param  {[type]} from  [ex: xpa address]\n * @param  {[type]} to    [ex: eth address]\n * @param  {[type]} value [ eth]\n * @param  {[type]} data  []\n * @param  {[type]} retry []\n * @return {[type]}       [description]\n */\nfunction getGasLimit(userAddress, to, value, data, retry) {\n    const param = {\n        from: userAddress,\n        to,\n        value,\n        data\n    }\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.estimateGas(param, (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    console.log('Gas Limit', result);\n                    resolve('0x' + bnTen(result).toString(16));\n                }\n            });\n        });\n    } else {\n        let retryCounter = retry > 0 ? retry : 5;\n        const waiting = 5000;\n\n        const body = {\n            jsonrpc: '2.0',\n            method: 'eth_estimateGas',\n            params: [param],\n            id: 7\n        };\n        return new Array(retryCounter).fill(0).reduce((prev) => {\n            return prev.then((rs) => {\n                if (rs) {\n                    return Promise.resolve(rs);\n                }\n                else {\n                    return ecRequest(body).then((res) => {\n                        const result = JSON.parse(res);\n                        if (result.error) {\n                            return new Promise((resolve) => {\n                                setTimeout(() => {\n                                    console.log('waiting', waiting, result.error);\n                                    resolve();\n                                }, waiting);\n                            });\n                        }\n                        else {\n                            console.log('success', res);\n                            return Promise.resolve(JSON.parse(res).result);\n                        }\n                    });\n                }\n            });\n        }, Promise.resolve());\n    }\n\n}\n\n/**\n * [ raw ]\n * @param  {[type]} nonce    [description]\n * @param  {[type]} gasPrice [description]\n * @param  {[type]} from     [description]\n * @param  {[type]} to       [description]\n * @param  {[type]} key      [description]\n * @param  {[type]} data     [description]\n * @param  {[type]} value    [description]\n * @return {[type]}          [description]\n */\nfunction sendRawTransaction(nonce, gasPrice, gasLimit, to, key, data, value) {\n    console.log('nonce: ', nonce, 'gasPrice: ', gasPrice, 'gasLimit', gasLimit);\n\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.getAccounts((err, accs) => {\n                if (err) {\n                    reject(err);\n                } else {\n                    if (accs.length < 1) return reject('Acount not found');\n                    web3.eth.sendTransaction({\n                        from: accs[0],\n                        data,\n                        to,\n                        value,\n                        gasPrice: bnHex(gasPrice.replace('0x', '')).toString(),\n                        gas: gasLimit,\n                        nonce: Number(nonce)\n                    }, (error, hash) => {\n                        if (error) {\n                            reject(error);\n                        } else {\n                            resolve(hash);\n                        }\n                    });\n                }\n            });\n        });\n    } else {\n        const privateKey = ethereumjs.Buffer.Buffer.from(key, 'hex');\n        const txParams = {\n            nonce,\n            gasPrice,\n            gasLimit,\n            to,\n            value,\n            data,\n            chainId: 1\n        };\n        const tx = new ethereumjs.Tx(txParams);\n        tx.sign(privateKey);\n        const serializedTx = tx.serialize();\n        const rawTx = `0x${serializedTx.toString('hex')}`;\n        const params = [rawTx];\n        const body = {\n            jsonrpc: '2.0',\n            method: 'eth_sendRawTransaction',\n            params,\n            id: 7\n        };\n        return ecRequest(body).then((res) => Promise.resolve(JSON.parse(res).result))\n    }\n}\n\nexport function calcFee(userAddress, to) {\n\n    const data = `0xa028d749${zero(userAddress.replace('0x', ''), 64)}${zero(to.amount, 64)}${zero('1', 64)}`;\n\n    if (useExtension) {\n        return new Promise((resolve, reject) => {\n            web3.eth.call({\n                to: xpaExchange,\n                data\n            }, (error, res) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    const result = res.substr(66, 64);\n                    const fee = bnHex(result).toString()\n                    resolve(Number(fee));\n                }\n            })\n        })\n    } else {\n        const data = {\n            jsonrpc: '2.0',\n            method: 'eth_call',\n            params: [{\n                to: xpaExchange,\n                data,\n            }, 'latest'],\n            id: 7\n        };\n\n        return ecRequest(data).then((res) => {\n            const result = JSON.parse(res).result;\n            const fee = result.substr(66, 64);\n            return Number(`0x${fee}`);\n        })\n            .catch(console.log);\n    }\n}\n\n/**\n * [Gas]\n * @param  {[type]} from        [description]\n * @param  {[type]} to          [description]\n * @param  {[type]} userAddress [description]\n * @param  {[type]} key         []\n * @param  {[type]} arr         []\n * @return {[type]}             [description]\n */\nexport const estimateGas = (from, to, userAddress, key, agent) => {\n    let nonce;\n    let gasPrice = minGasPrice;\n    let fromDecimal = 18;\n    let toDecimal = 18;\n    let data = '';\n    let value = '0x0';\n\n    if (from.address === ethAddress && to.address !== ethAddress) // from ETH to token\n    {\n        return getNonce(userAddress).then((n) => {\n            nonce = n;\n            return getGasPrice();\n        })\n            .then((g) => {\n                gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n                return getDecimal(to);\n            })\n            .then((des) => {\n                toDecimal = des;\n                data = `${sha3('userTakeOrder(address,address,uint256,uint256,address)')\n                    .substr(0, 10)}${zero('0', 64)}${zero(to.address.replace('0x', ''), 64)}${zero(from.price, 64)}${zero(from.amount, 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n                value = `0x${from.amount}`;\n                return getGasLimit(`0x${userAddress}`, xpaExchange, value, data, 50);\n            })\n            .then((num) => {\n                const gasLimit = num;\n\n                return {\n                    nonce,\n                    gasPrice,\n                    gasLimit,\n                    fromDecimal,\n                    toDecimal,\n                    from,\n                    to,\n                    key,\n                    data,\n                    value,\n                    agent\n                };\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n    else {\n        return getNonce(userAddress).then((n) => {\n            nonce = n;\n            return getGasPrice();\n        })\n            .then((g) => {\n                gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n                return getDecimal(from);\n            })\n            .then((des) => {\n                fromDecimal = Number(des);\n                return getDecimal(to);\n            })\n            .then((des) => {\n                toDecimal = Number(des);\n                return getAllowance(`0x${userAddress}`, from, xpaExchange);\n            })\n            .then((ap) => {\n                console.log('allowance', ap);\n                data = `${sha3('userTakeOrder(address,address,uint256,uint256,address)')\n                    .substr(0, 10)}${zero(from.address.replace('0x', ''), 64)}${zero(to.address.replace('0x', ''), 64)}${zero(from.price, 64)}${zero(from.amount, 64)}${agent ? '' : zero(agent.replace('0x', ''), 64)}`;\n                if (Number(ap) === 0) {\n                    return getGasLimit(`0x${userAddress}`, xpaExchange, value, data, 50);\n                }\n                else {\n                    const approve = `${sha3('approve(address,uint256)')\n                        .substr(0, 10)}${zero(xpaExchange.replace('0x', ''), 64)}${zero('0', 64)}`;\n\n                    return sendRawTransaction(nonce, gasPrice, approveGasLimit, from.address, key, approve, '0x0').then((res) => {\n                        return checkReceipt(res);\n                    })\n                        .then(() => {\n                            return getGasLimit(`0x${userAddress}`, from.address, '0x0', data, 50);\n                        });\n                }\n            })\n            .then((num) => {\n                const gasLimit = num;\n                return {\n                    nonce,\n                    gasPrice,\n                    gasLimit,\n                    from,\n                    to,\n                    key,\n                    data,\n                    value,\n                    fromDecimal,\n                    toDecimal,\n                    agent,\n                    userAddress\n                };\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n};\n\nexport const observerAllowance = (from, userAddress) => {\n    return getAllowance(userAddress, from, xpaExchange)\n        .then((allowance) => {\n            return allowance;\n        })\n        .catch(() => {\n            return false;\n        });\n};\n\nexport const observerCheckApprove = (userAddress, data) => {\n    return getGasLimit(`0x${userAddress}`, xpaExchange, '0x0', data, 50).then((unit) => {\n        return unit;\n    });\n};\n\nexport const observerApprove = (from) => {\n    const approve = `${sha3('approve(address,uint256)')\n        .substr(0, 10)}${zero(xpaExchange.replace('0x', ''), 64)}${zero(from.amount, 64)}`;\n\n    return `iban:${eciban.toIBAN(from.address)}?data=${approve}&value=0&amount=0`;\n};\n\nexport const observerEstimatGas = (from, to, userAddress, agent, reduce) => {\n    let fromDecimal = 18;\n    let toDecimal = 18;\n    let data;\n    let value = '0x0';\n    let approve;\n\n    if (from.address === ethAddress && to.address !== ethAddress) // from ETH to token\n    {\n        return getDecimal(to)\n            .then((des) => {\n                data = `${sha3('userTakeOrder(address,address,uint256,uint256,address)').substr(0, 10)}${zero(from.address.replace('0x', ''), 64)}${zero(to.address.replace('0x', ''), 64)}${zero(from.price, 64)}${zero(from.amount, 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n                value = `0x${from.amount}`;\n                return getGasLimit(`0x${userAddress}`, xpaExchange, value, data, 50);\n            })\n            .then((num) => {\n                const gasLimit = num;\n\n                return {\n                    gasLimit,\n                    from,\n                    to,\n                    data,\n                    value,\n                    agent\n                };\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n    else {\n        return getDecimal(from)\n            .then((des) => {\n                fromDecimal = Number(des);\n                return getDecimal(to);\n            })\n            .then((des) => {\n                toDecimal = Number(des);\n                return observerApprove(from);\n            })\n            .then((ap) => {\n                data = `${sha3('userTakeOrder(address,address,uint256,uint256,address)').substr(0, 10)}${zero(from.address.replace('0x', ''), 64)}${zero(to.address.replace('0x', ''), 64)}${zero(from.price, 64)}${zero(from.amount, 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n                approve = ap;\n                return getGasLimit(`0x${userAddress}`, xpaExchange, value, data, 50);\n            })\n            .then((num) => {\n                const gasLimit = num;\n                return {\n                    gasLimit,\n                    from,\n                    to,\n                    data,\n                    value,\n                    fromDecimal,\n                    toDecimal,\n                    agent,\n                    userAddress,\n                    approve,\n                };\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n};\n\n/**\n * []\n * @param  {[type]} from        [description]\n * @param  {[type]} to          [description]\n * @param  {[type]} userAddress [description]\n * @param  {[type]} key         []\n * @param  {[type]} arr         []\n * @return {[type]}             [description]\n */\nexport async function transaction(tx) {\n    console.log(tx);\n    let _receipt;\n    if (tx.from.address === ethAddress && tx.to.address !== ethAddress) // from ETH to token\n    {\n        return sendRawTransaction(tx.nonce, tx.gasPrice, tx.gasLimit, xpaExchange, tx.key, tx.data, tx.value)\n            .then((receipt) => {\n                _receipt = receipt;\n                return checkReceipt(receipt);\n            })\n            .then(() => {\n                return _receipt;\n            })\n            .catch(() => {\n                return false;\n            });\n    }\n    else {\n        const approve = `${sha3('approve(address,uint256)')\n            .substr(0, 10)}${zero(xpaExchange.replace('0x', ''), 64)}${zero(tx.from.amount, 64)}`;\n        console.log('data', approve);\n        return sendRawTransaction(tx.nonce, tx.gasPrice, approveGasLimit, tx.from.address, tx.key, approve, '0x0')\n            .then((res) => {\n                return checkReceipt(res);\n            }).then(() => {\n                tx.nonce = `0x${(parseInt(tx.nonce, 16) + 1).toString(16)}`;\n                return getGasLimit(`0x${tx.userAddress}`, xpaExchange, '0x0', tx.data, 50);\n            })\n            .then((res) => {\n                const limit = res;\n                console.log('new limit', limit);\n                return sendRawTransaction(tx.nonce, tx.gasPrice, limit, xpaExchange, tx.key, tx.data, '0x0');\n            })\n            .then((receipt) => {\n                _receipt = receipt;\n                return checkReceipt(receipt);\n            })\n            .then(() => {\n                return _receipt;\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n}\n\n\n// export const checkApprove = (userAddress, from) =>\n// {\n//     return getAllowance(`0x${userAddress}`, from, xpaExchange).then((res) =>\n//     {\n//         console.log(res);\n//         return JSON.parse(res).result;\n//     });\n// };\n\n/**\n * [ qrcode ]\n * @param  {[type]} from [description]\n * @param  {[type]} to   [description]\n * @param  {[type]} arr  [description]\n * @return {[type]}      [description]\n */\nexport function createStream(tx) {\n    // let approve;\n    console.log(tx);\n    if (tx.from.address === ethAddress && tx.to.address !== ethAddress) {\n        return Promise.resolve({ raw: `iban:${eciban.toIBAN(xpaExchange)}?data=${tx.data}&value=${Number(tenFill(bnHex(tx.from.amount).toString(), -18))}&amount=${Number(tenFill(bnHex(tx.from.amount).toString(), -18))}` });\n    }\n    else {\n        // approve = `${sha3('approve(address,uint256)').substr(0, 10)}${zero(xpaExchange.replace('0x', ''), 64)}${zero(calAmount(tx.from.amount, tx.fromDecimal), 64)}`;\n        return Promise.resolve({ approve: tx.approve, raw: `iban:${eciban.toIBAN(xpaExchange)}?data=${tx.data}&value=0&amount=0` });\n    }\n}\n\n// export function initDecimal(array)\n// {\n//     const body = [];\n//     const result = [];\n//     array.forEach((token) =>\n//     {\n//         if (token.address === ethAddress)\n//         {\n//             result.push(18);\n//         }\n//         else\n//         {\n//             const data = {\n//                 jsonrpc: '2.0',\n//                 method: 'eth_call',\n//                 params: [{\n//                     to: token.address,\n//                     data: `${sha3('decimals()')).substr(0, 10)}000000000000000000000000`,\n//                 }, 'latest'],\n//                 id: 7\n//             };\n//             body.push(data);\n//         }\n//     });\n//     return ecRequest(body).then((res) =>\n//     {\n//         JSON.parse(res).forEach((r) =>\n//         {\n//             result.push(parseInt(r.result, 16));\n//         });\n//         return new Promise((resolve) =>\n//         {\n//             resolve(result);\n//         });\n//     });\n// }\n\nexport function estimateCancel(from, to, userAddress, key, agent) {\n    let gasPrice = minGasPrice;\n    let data;\n    data = `${sha3('userCancelOrder(address,address,uint256,uint256,address)')\n        .substr(0, 10)}${zero(from.address.replace('0x', ''), 64)}${zero(to.address.replace('0x', ''), 64)}${zero(from.price, 64)}${zero(from.amount, 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n\n    return getGasPrice()\n        .then((g) => {\n            gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n            return getGasLimit(`0x${userAddress}`, xpaExchange, '0x0', data, 50);\n        })\n        .then((res) => {\n            return {\n                gasLimit: res,\n                key,\n                userAddress,\n                data,\n                gasPrice\n            };\n        })\n        .catch((err) => {\n            console.log(err);\n        });\n}\n\nexport function cancelOrder(tx) {\n    let nonce;\n    let _receipt;\n\n    return getNonce(tx.userAddress).then((n) => {\n        nonce = n;\n        return sendRawTransaction(nonce, tx.gasPrice, tx.gasLimit, xpaExchange, tx.key, tx.data, '0x0');\n    })\n        .then((receipt) => {\n            _receipt = receipt;\n            checkReceipt(receipt);\n        })\n        .then(() => {\n            return _receipt;\n        })\n        .catch(false);\n}\n\nexport function cancelStream(tx) {\n    return (`iban:${eciban.toIBAN(xpaExchange)}?data=${tx.data}`);\n}\n\nexport function showMeMoney(testAddress, userAddress, key) {\n    let nonce;\n    let gasPrice = minGasPrice;\n    let data;\n    return getNonce(testAddress).then((n) => {\n        nonce = n;\n        return getGasPrice();\n    })\n        .then((g) => {\n            gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n            data = `${sha3('showMeTheMoney(address)').substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}`;\n            return getGasLimit(`0x${testAddress}`, richAddress, '0x0', data, 5);\n        })\n        .then((res) => {\n            return sendRawTransaction(nonce, gasPrice, res, richAddress, key, data, '0x0');\n        });\n}\n\n// export async function getAssets()\n// {\n//     const result = await web3.eth.call({\n//         to: XPAAsset,\n//         data: `0x66acdd34${zero('0', 64)}`\n//     });\n//     console.log('all assets: ', result);\n//     return result;\n// }\n\nexport async function getMortgageRate(userAddress) {\n    return new Promise((resolve, reject) => {\n        setWeb3Provider();\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('getMortgageRate(address)').substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}`,\n        }, (error, result) => {\n            if (error) {\n                reject(reject)\n            } else {\n                resolve(subHex(result));\n            }\n        });\n    })\n}\n\nexport async function getHighestMortgageRate() {\n    setWeb3Provider();\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('getHighestMortgageRate()').substr(0, 10)}`,\n        }, (error, result) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(result)\n            }\n        });\n    })\n}\n\nexport async function getUsableXPA(userAddress) {\n    setWeb3Provider();\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('getUsableXPA(address)').substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}`\n        }, (error, result) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(subHex(result));\n            }\n        });\n    })\n}\n\nexport async function getClosingLine() {\n    setWeb3Provider();\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('getClosingLine()').substr(0, 10)}`\n        }, (error, result) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(result);\n            }\n        });\n    })\n}\n\nexport function getMortgagePrice() {\n    const promises = [];\n    const result = {};\n    setWeb3Provider();\n\n    const call = (key) => {\n        return new Promise((resolve, rejex) => {\n            return web3.eth.call({\n                to: XPAAsset,\n                data: `${Web3.utils.sha3('getPrice(address)').substr(0, 10)}${zero(cash[key].replace('0x', ''), 64)}`\n            }, 'latest', (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(result)\n                }\n            });\n        })\n\n    };\n\n    Object.keys(cash).map((key) => {\n        if (key === 'XPA') {\n            return null;\n        }\n        else {\n            result[key] = '';\n            return promises.push(call(key));\n        }\n    });\n\n    return Promise.all(promises).then((res) => {\n        Object.keys(result).forEach((d, i) => {\n            result[d] = subHex(res[i]);\n        });\n\n        return result;\n    });\n}\n\nexport async function getEquvialentAmount(userAddress) {\n    setWeb3Provider();\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `0x6790aee8${zero(userAddress.replace('0x', ''), 64)}`\n        }, (error, result) => {\n            if (error) {\n                reject(error)\n            } else {\n                resolve(subHex(result));\n            }\n        });\n    })\n}\n\nexport function getAmount(userAddress, type) {\n    let method;\n    const promises = [];\n    const result = {};\n    setWeb3Provider();\n\n    if (type === 'usable') {\n        method = 'getUsableAmount';\n    }\n    else if (type === 'loan') {\n        method = 'getLoanAmount';\n    }\n    else {\n        method = 'getRemainingAmount';\n    }\n\n    const call = (key) => {\n        return new Promise((resolve, reject) => {\n            web3.eth.call({\n                to: XPAAsset,\n                data: `${sha3(`${method}(address,address)`).substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}${zero(cash[key].replace('0x', ''), 64)}`\n            }, 'latest', (error, result) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(result);\n                }\n            });\n        })\n    };\n\n    Object.keys(cash).map((key) => {\n        if (key === 'XPA') {\n            return null;\n        }\n        else {\n            result[key] = '';\n            return promises.push(call(key));\n        }\n    });\n\n    return Promise.all(promises).then((res) => {\n        Object.keys(result).forEach((d, i) => {\n            result[d] = subHex(res[i]);\n        });\n\n        return result;\n    });\n}\n\nasync function withdrawFee() {\n    setWeb3Provider();\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('withdrawFeeRate()').substr(0, 10)}`\n        }, (error, result) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(parseInt(result, 16));\n            }\n        });\n    })\n}\n\nasync function offsetFee() {\n    setWeb3Provider();\n\n    return new Promise((resolve, reject) => {\n        web3.eth.call({\n            to: XPAAsset,\n            data: `${sha3('offsetFeeRate()').substr(0, 10)}`\n        }, (error, result) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(result);\n            }\n        });\n    })\n}\n\nexport function estimateMortgage(from, to, userAddress, key, agent) {\n    let fromDecimal = 18;\n    let nonce;\n    let gasPrice = minGasPrice;\n    let value = '0x0';\n    let data;\n    const gasLimit = '0x13880';\n\n    return getNonce(userAddress).then((n) => {\n        nonce = n;\n        return getGasPrice();\n    }).then((g) => {\n        gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n        console.log('gasPrice', gasPrice);\n        return getAllowance(`0x${userAddress}`, from, XPAAsset);\n    })\n        .then((ap) => {\n            console.log('allowance is', JSON.parse(ap).result);\n            data = `${sha3('mortgage(address)')\n                .substr(0, 10)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n            if (Number(JSON.parse(ap).result) === 0) {\n                return Promise.resolve();\n            }\n            else {\n                const approve = `${sha3('approve(address,uint256)')\n                    .substr(0, 10)}${zero(XPAAsset.replace('0x', ''), 64)}${zero('0', 64)}`;\n                console.log('approve 0');\n                return sendRawTransaction(nonce, gasPrice, approveGasLimit, from.address, key, approve, '0x0').then((res) => {\n                    return checkReceipt(res);\n                })\n                    .then(() => {\n                        return Promise.resolve();\n                    });\n            }\n        })\n        .then(() => {\n            return {\n                nonce,\n                gasPrice,\n                gasLimit,\n                from,\n                to,\n                key,\n                data,\n                value,\n                fromDecimal,\n                userAddress,\n            };\n        })\n        .catch((err) => {\n            console.log(err);\n            return false;\n        });\n}\n\nexport function mortgage(tx) {\n    console.log(tx);\n    const approve = `${sha3('approve(address,uint256)')\n        .substr(0, 10)}${zero(XPAAsset.replace('0x', ''), 64)}${zero(calAmount(tx.from.amount, 18), 64)}`;\n\n    console.log(approve);\n    return sendRawTransaction(tx.nonce, tx.gasPrice, approveGasLimit, tx.from.address, tx.key, approve, '0x0')\n        .then((res) => {\n            return checkReceipt(res);\n        }).then(() => {\n            return getAllowance(`0x${tx.userAddress}`, tx.from, XPAAsset);\n        })\n        .then((allow) => {\n            console.log(allow);\n            tx.nonce = `0x${(parseInt(tx.nonce, 16) + 1).toString(16)}`;\n            return getGasLimit(`0x${tx.userAddress}`, XPAAsset, '0x0', tx.data, 50);\n        })\n        .then((res) => {\n            const limit = res;\n            return sendRawTransaction(tx.nonce, tx.gasPrice, limit, XPAAsset, tx.key, tx.data, '0x0');\n        })\n        .then((res) => {\n            return checkReceipt(res);\n        })\n        .then(() => {\n            console.log('mortgage success');\n            return true;\n        })\n        .catch((err) => {\n            console.log(err);\n            return false;\n        });\n}\n\nexport async function estimateAct(from, userAddress, key, method, agent) {\n    let nonce;\n    let gasPrice = minGasPrice;\n    console.log(from, method);\n    let data;\n    if (from.cash === 'XPA') {\n        data = `${sha3('withdrawXPA(uint256,address)').substr(0, 10)}${zero(calAmount(from.amount, 18), 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n    }\n    else {\n        data = `${sha3(`${method === 'withdraw' ? 'withdraw' : 'repayment'}(address,uint256,address)`).substr(0, 10)}${zero(cash[from.cash].replace('0x', ''), 64)}${zero(calAmount(from.amount, 18), 64)}${agent ? zero('0', 64) : zero(agent.replace('0x', ''), 64)}`;\n    }\n    let fee = 0;\n    if (method === 'withdraw') {\n        fee = await withdrawFee();\n    }\n\n    return getNonce(userAddress).then((n) => {\n        nonce = n;\n        return getGasPrice();\n    })\n        .then((g) => {\n            gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n            return getGasLimit(`0x${userAddress}`, XPAAsset, '0x0', data, 50);\n        })\n        .then((num) => {\n            const gasLimit = num;\n\n            return {\n                nonce,\n                gasPrice,\n                gasLimit,\n                from,\n                key,\n                data,\n                userAddress,\n                approve: method === 'withdraw' ? false : true,\n                fee\n            };\n        })\n        .catch((err) => {\n            console.log(err);\n            return false;\n        });\n}\n\nexport function doAct(tx) {\n    let _receipt;\n\n    if (tx.approve) {\n        const approve = `${sha3('approve(address,uint256)').substr(0, 10)}${zero(XPAAsset.replace('0x', ''), 64)}${zero(calAmount(tx.from.amount, 18), 64)}`;\n        return sendRawTransaction(tx.nonce, tx.gasPrice, approveGasLimit, cash[tx.from.cash], tx.key, approve, '0x0')\n            .then((res) => {\n                return checkReceipt(res);\n            }).then(() => {\n                tx.nonce = `0x${(parseInt(tx.nonce, 16) + 1).toString(16)}`;\n                return getGasLimit(`0x${tx.userAddress}`, XPAAsset, '0x0', tx.data, 50);\n            })\n            .then((res) => {\n                const limit = res;\n                return sendRawTransaction(tx.nonce, tx.gasPrice, limit, XPAAsset, tx.key, tx.data, '0x0');\n            })\n            .then((receipt) => {\n                _receipt = receipt;\n                return checkReceipt(receipt);\n            })\n            .then(() => {\n                return _receipt;\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n    else {\n        return sendRawTransaction(tx.nonce, tx.gasPrice, tx.gasLimit, XPAAsset, tx.key, tx.data, '0x0')\n            .then((receipt) => {\n                _receipt = receipt;\n                return checkReceipt(receipt);\n            })\n            .then(() => {\n                return _receipt;\n            })\n            .catch((err) => {\n                console.log(err);\n                return false;\n            });\n    }\n}\n\nexport async function estimateOffset(userAddress, key, type) {\n    let nonce;\n    let gasPrice = minGasPrice;\n    const contract = XPAAsset;\n    const data = `${sha3('offset(address,address)').substr(0, 10)}${zero(userAddress.replace('0x', ''), 64)}${zero(cash[type].replace('0x', ''), 64)}`;\n    const fee = await offsetFee();\n    return getNonce(userAddress).then((n) => {\n        nonce = n;\n        return getGasPrice();\n    })\n        .then((g) => {\n            gasPrice = Number(g) >= Number(minGasPrice) ? g : minGasPrice;\n            return getGasLimit(`0x${userAddress}`, contract, '0x0', data, 50);\n        })\n        .then((num) => {\n            const gasLimit = num;\n            return {\n                nonce,\n                gasPrice,\n                gasLimit,\n                data,\n                userAddress,\n                contract,\n                key,\n                fee\n            };\n        })\n        .catch((err) => {\n            console.log(err);\n            return false;\n        });\n}\n\nexport function doOffset(tx) {\n    return sendRawTransaction(tx.nonce, tx.gasPrice, tx.gasLimit, tx.contract, tx.key, tx.data, '0x0')\n        .then((res) => {\n            return checkReceipt(res);\n        })\n        .then(() => {\n            return true;\n        })\n        .catch((err) => {\n            console.log(err);\n            return false;\n        });\n}\n\nexport const mailTo = (body) => {\n    const hash = echashcash('/mailto/support@xpa.exchange');\n    return ecRequest(body, 'https://betarpc.xpa.exchange/mailto/support@xpa.exchange', hash)\n        .then(() => {\n            return true;\n        })\n        .catch(() => {\n            return false;\n        });\n};\n\n","export const SET_NEWS = 'SET_NEWS';\n","import React from 'react';\nimport { translate } from 'react-i18next';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport { bnHex, tenFill, formatNumber } from '../../utils/format';\nimport './tokenList.scss';\n\nclass TokenList extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n        this.state = {\n            filter: '',\n            // eslint-disable-next-line no-undef\n            base: { token: 'ETH', address: finalConfig.ethAddress, decimal: 18 },\n            favorite: JSON.parse(localStorage.getItem('favorite')) || []\n        };\n\n        this.favoriteToggle = this.favoriteToggle.bind(this);\n        this.filter = this.filter.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    changeToken(t)\n    {\n        let basic = {};\n\n        if (t === 'FAV')\n        {\n            basic = { token: 'FAV', address: '' };\n        }\n        else\n        {\n            basic = this.props.tokenList.find(d => d.token === t && d.basic === true);\n            // console.log(t, basic);\n        }\n        this.setState(update(this.state, {\n            base: { $set: basic },\n        }));\n    }\n\n    favoriteToggle(item, e)\n    {\n        e.stopPropagation();\n\n        // \n        if (this.state.favorite.indexOf(item.id) === -1)\n        {\n            this.setState(update(this.state, {\n                favorite: { $push: [item.id] }\n            }), () => {\n                localStorage.setItem('favorite', JSON.stringify(this.state.favorite));\n            });\n        }\n        else // , \n        {\n            let addressId = this.state.favorite.filter((val) => {\n                return val !== item.id;\n            });\n\n            this.setState(update(this.state, {\n                favorite: { $set: addressId }\n            }), () => {\n                localStorage.setItem('favorite', JSON.stringify(this.state.favorite));\n            });\n        }\n    }\n\n    filter(e)\n    {\n        this.setState(update(this.state, {\n            filter: { $set: e.target.value }\n        }));\n    }\n\n    handleClick()\n    {\n        if (this.state.filter !== '')\n        {\n            this.setState(update(this.state, {\n                filter: { $set: '' }\n            }));\n        }\n    }\n\n    renderMenu()\n    {\n        const { tradeList, select, tokenList, t } = this.props;\n        const { base, filter, favorite } = this.state;\n\n        let listArray = [];\n        let list;\n        let searchStyle = '';\n\n        if (!tradeList[base.token] && base.token !== 'FAV')\n        {\n            return null;\n        }\n\n        // favoriteData\n        let favoriteData = [];\n        if (favorite.length > 0)\n        {\n            for (let key in tradeList)\n            {\n                for (let val of tradeList[key])\n                {\n                    if (favorite.indexOf(val.id) !== -1)\n                    {\n                        favoriteData.push(val);\n                    }\n                }\n            }\n        }\n\n        // filter\n        if (filter !== '')\n        {\n            if (base.token !== 'FAV')\n            {\n                listArray = tradeList[base.token].filter(l => l.token.toLowerCase().indexOf(filter.toLowerCase()) > -1);\n            }\n            else\n            {\n                // \n                listArray = favoriteData.filter(l => l.token.toLowerCase().indexOf(filter.toLowerCase()) > -1);\n            }\n        }\n        else\n        {\n            listArray = (base.token !== 'FAV') ? tradeList[base.token] : favoriteData;\n        }\n\n        if (listArray.length > 0)\n        {\n            list = listArray.map((l, i) =>\n            {\n                const isFavorite = (this.state.favorite.indexOf(l.id) !== -1) ? 'checked' : '';\n                const fav = tokenList.find(d => d.token === l.base && d.basic === true);\n                // if(!fa)\n                // {\n                //     localStorage.clear\n                // }\n                const from = tokenList.find(d => d.address === l.address) || { decimal: 18 };\n                const to = tokenList.find(d => d.address === base.address) || { decimal: 18 };\n                const baseAddress = (base.token === 'FAV' && fav) ? fav.address : base.address;\n                return (\n                    <li key={l.id} onClick={() => { select({ type: l.base, baseAddress, id: l.id, decimal: 18 }); }}>\n                        <div>\n                            <i onClick={(e) => { this.favoriteToggle(l, e); }} className={`fa fa-star ${isFavorite}`} aria-hidden=\"true\" />\n                        </div>\n                        <div className=\"desc\"><span>{l.token}</span>/{l.base}</div>\n                        <div className=\"price\">{formatNumber(8, tenFill(bnHex(l.latest).toString(), from.decimal - 18 - to.decimal))}</div>\n                        <div className={String(l.growth).indexOf('-') > -1 ? 'ratio red' : 'ratio green'}>{l.growth}%</div>\n                    </li>\n                );\n            });\n        }\n        else\n        {\n            // list = <div className=\"no-result\">{t('header.noResult')}</div>;\n            list = null;\n            if (filter !== '')\n            {\n                searchStyle = 'no-result';\n            }\n        }\n\n        const type = Object.keys(tradeList).map((k) =>\n        {\n            return (\n                <div key={k} onClick={() => this.changeToken(`${k}`)} className={this.state.base.token === `${k}` ? 'active' : ''}>{k}</div>\n            );\n        });\n\n        return (\n            <div>\n                <div className=\"search\">\n                    <input\n                        type=\"text\"\n                        className={searchStyle === 'no-result' ? searchStyle : ''}\n                        onChange={this.filter}\n                        value={filter}\n                    />\n                    <img src={`/img/icon/${filter === '' ? 'ic-search.svg' : 'ic-del.svg'}`} alt=\"search\" onClick={this.handleClick} />\n                </div>\n                <div className=\"option\">\n                    <div onClick={() => this.changeToken('FAV')} className={base.token === 'FAV' ? 'active' : ''}>{this.props.t('table.star')}</div>\n                    {type}\n                </div>\n                <li className=\"list-title\">\n                    <div />\n                    <div />\n                    <div>{t('header.lastPrice')}</div>\n                    <div>{t('header.change')}</div>\n                </li>\n                <ul className=\"list\">\n                    {list}\n                </ul>\n            </div>\n        );\n    }\n\n    render()\n    {\n        return (\n            <div className=\"c_tokenList\">\n                {this.renderMenu()}\n            </div>\n        );\n    }\n}\n\nTokenList.defaultProps = {\n    t: () => {},\n};\n\nTokenList.propTypes = {\n    tradeList: PropTypes.object.isRequired,\n    select: PropTypes.func.isRequired,\n    t: PropTypes.func,\n    tokenList: PropTypes.array.isRequired,\n};\n\nexport default translate()(TokenList);\n","if (process.env.NODE_ENV === 'production')\n{\n    module.exports = require('./configureStore.prod');\n}\nelse\n{\n    module.exports = require('./configureStore.dev');\n}\n","/* eslint-disable no-undef */\nimport React from 'react';\nimport update from 'immutability-helper';\nimport { translate } from 'react-i18next';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { withRouter } from 'react-router';\n\n// import Language from '../language/language';\nimport { language } from '../../constants/languageType';\nimport i18n from '../../i18n/i18n';\nimport { formatNumber, bnHex, tenFill } from '../../utils/format';\nimport TokenList from '../tokenList/tokenList';\n\nimport './header.scss';\n\n@withRouter\nclass Header extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n        this.state = {\n            lang: localStorage.getItem('i18nextLng'),\n            menu: ['exchange', 'mortgage', 'currency'],\n            showMenu: false,\n            showList: false,\n            showContract: false\n        };\n        this.changeHeader = this.changeHeader.bind(this);\n        this.renderMenu = this.renderMenu.bind(this);\n        this.renderLanguage = this.renderLanguage.bind(this);\n        this.renderSummary = this.renderSummary.bind(this);\n        this.renderContract = this.renderContract.bind(this);\n        this.select = this.select.bind(this);\n        this.closeList = this.closeList.bind(this);\n    }\n\n    // addToken()\n    // {\n    //     if (!this.state.add)\n    //     {\n    //         this.setState(update(this.state, {\n    //             add: { $set: true }\n    //         }));\n    //     }\n    //     else\n    //     {\n    //         if (this.state.new_token === '') return console.log('not add');\n    //         this.props.addTokenIO(this.state.new_token);\n    //         Io.emit('newToken', { address: this.state.new_token });\n    //         this.setState(update(this.state, {\n    //             add: { $set: false },\n    //             modal: { $set: true },\n    //         }));\n    //         this.address.value = '';\n\n    //         setTimeout(() =>\n    //         {\n    //             this.setState(update(this.state, {\n    //                 modal: { $set: false },\n    //                 new_token: { $set: '' }\n    //             }));\n    //         }, 3000);\n    //     }\n    // }\n\n    // enterToken(e)\n    // {\n    //     this.setState(update(this.state, {\n    //         new_token: { $set: e.target.value }\n    //     }));\n    // }\n\n    componentDidMount()\n    {\n        if (this.props.dash)\n        {\n            window.addEventListener('click', this.closeList);\n        }\n    }\n\n    shouldComponentUpdate(nextProp, nextState)\n    {\n        if (this.props.dash || this.state.showMenu !== nextState.showMenu || this.state.lang !== nextState.lang)\n        {\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n\n    componentWillUnmount()\n    {\n        if (this.props.dash)\n        {\n            window.removeEventListener('click', this.closeList);\n        }\n    }\n\n    changeHeader(lan)\n    {\n        const tar = language.find(l => l.type === lan);\n        i18n.changeLanguage(tar.name);\n        this.setState(update(this.state, {\n            lang: { $set: localStorage.getItem('i18nextLng') }\n        }));\n    }\n\n    closeList(e)\n    {\n        if ((this.list && !this.list.contains(e.target)) && !this.desc.contains(e.target))\n        {\n            this.setState(update(this.state, {\n                showList: { $set: false }\n            }));\n        }\n\n        // if (!this.contractBtn.contains(e.target) && !this.contract.contains(e.target))\n        // {\n        //     this.setState(update(this.state, {\n        //         showContract: { $set: false }\n        //     }));\n        // }\n    }\n\n    select(obj)\n    {\n        const { myTransaction, select, actions } = this.props;\n        select(obj);\n        this.setState(update(this.state, {\n            showList: { $set: false }\n        }));\n        actions.userActions.myTransactionChange({\n            price: '',\n            amount: '',\n            able: false,\n            total: '-',\n            act: myTransaction.act\n        });\n    }\n\n    renderContract()\n    {\n        const { t } = this.props;\n\n        return (\n            <div\n                className=\"contract\"\n                ref={(el) => { this.contractBtn = el; }}\n                onMouseEnter={() => { this.setState(update(this.state, { showContract: { $set: true } })); }}\n                onMouseLeave={() => { this.setState(update(this.state, { showContract: { $set: false } })); }}\n            >\n                <i className=\"fa fa-file-text-o\" aria-hidden=\"true\" />\n                <p>{t('header.contract')}</p>\n                <i className=\"fa fa-chevron-down\" aria-hidden=\"true\" />\n                <div className={this.state.showContract ? 'open' : ''} ref={(el) => { this.contract = el; }}>\n                    <div>\n                        <span>Etherscan {t('header.contract')}</span>\n                    </div>\n                    <div>\n                        <a className=\"link\" target=\"_blank\" href=\"https://etherscan.io/address/0x8ea74569c1b9bbb13780114b6b5e93396910070a\">\n                            <div>{finalConfig.xpaExchange}</div>\n                            <div> the current smart contart</div>\n                        </a>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    renderLanguage()\n    {\n        return language.map((item) =>\n        {\n            return (\n                <div key={item.name} className={this.state.lang === item.name ? 'active' : ''} onClick={() => { this.changeHeader(item.type); }}>\n                    <a>{item.type}</a>\n                    {this.state.lang === item.name ? <i className=\"fa fa-check\" aria-hidden=\"true\" /> : null}\n                </div>\n            );\n        });\n    }\n\n    renderList()\n    {\n        const { tradeList, actions, tokenList } = this.props;\n        return (\n            <div className={this.state.showList ? 'token show' : 'token'} ref={(el) => { this.list = el; }}>\n                <TokenList\n                    tradeList={tradeList}\n                    select={this.select}\n                    actions={actions}\n                    tokenList={tokenList}\n                />\n            </div>\n        );\n    }\n\n    renderMenu()\n    {\n        const { t } = this.props;\n        return this.state.menu.map((item) =>\n        {\n            return (\n                <div key={item} className={this.props.match.path.replace('/', '') === item ? 'active' : ''}>\n                    <Link to={item}>\n                        {t(`header.${item}`)}\n                    </Link>\n                </div>\n            );\n        });\n    }\n\n    renderSummary()\n    {\n        const { from, to, tradeList, t } = this.props;\n        if (Object.keys(tradeList) < 1) return null;\n        const summary = tradeList[to.token] ? tradeList[to.token].find(d => d.address === from.address) : {\n            latest: 0,\n            growth: 0,\n            max: 0,\n            min: 0,\n            amount: 0\n        };\n\n        return (\n            <div className=\"summary\">\n                {this.renderList()}\n                <div className=\"desc\" ref={(el) => { this.desc = el; }} onClick={() => { this.setState(update(this.state, { showList: { $set: !this.state.showList }, showMenu: { $set: false } })); }}>\n                    <div>\n                        <span>{from.token}/{to.token}</span>\n                        <span>{t('header.chooseToken')}</span>\n                    </div>\n                    <i className=\"fa fa-chevron-down\" aria-hidden=\"true\" />\n                </div>\n                <div className=\"rate\">\n                    <span>\n                        {formatNumber(8, tenFill(bnHex(summary.latest).toString(), from.decimal - 18 - to.decimal))}\n                    </span>\n                    <span className={summary.growth >= 0 ? 'up' : 'down'}>\n                        {formatNumber(4, summary.growth)}%\n                    </span>\n                </div>\n                <div className=\"infor\">\n                    <div>\n                        <p>\n                            {t('header.24hrHigh')}\n                        </p>\n                        <span>\n                            {formatNumber(8, tenFill(bnHex(summary.max).toString(), from.decimal - 18 - to.decimal)) || 0}\n                        </span>\n                    </div>\n                    <div>\n                        <p>\n                            {t('header.24hrLow')}\n                        </p>\n                        <span>\n                            {formatNumber(8, tenFill(bnHex(summary.min).toString(), from.decimal - 18 - to.decimal)) || 0}\n                        </span>\n                    </div>\n                    <div>\n                        <p>\n                            {t('header.24hrVolume')}\n                        </p>\n                        <span>\n                            {formatNumber(8, tenFill(bnHex(summary.amount).toString(), -from.decimal))} {from.token}\n                        </span>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    render()\n    {\n        const { lang } = this.state;\n        const { t } = this.props;\n\n        const production = finalConfig.production;\n\n        const guide = () =>\n        {\n            switch (lang)\n            {\n                case 'zh-cn':\n                    return 'https://www.weibo.com/ttarticle/p/show?id=2309404226836979686902';\n                case 'zh-tw':\n                    return 'https://medium.com/@xpa_76300/xpa-exchange-%E6%96%B0%E6%89%8B%E4%B8%8A%E8%B7%AF-e85247bae3b';\n                default:\n                    return 'https://medium.com/tideisun-blog/xpa-exchange-a-gif-guide-to-making-a-trade-4eda6f7c3c76';\n            }\n        };\n\n        return (\n            <header className=\"c_header\">\n                <div className={this.state.showList || this.state.showContract ? 'header-desktop block' : 'header-desktop'}>\n                    {!production ? <img className=\"beta\" src=\"/img/Beta-Ribbon.png\" alt=\"beta\" /> : ''}\n                    <h1>\n                        <Link to=\"/\">\n                            <div className=\"logo\"><img src=\"/img/logo_xpaex.png\" alt=\"xpa\" /></div>\n                            XPA<span className=\"small-title\">Exchange</span>\n                        </Link>\n                        {/* <span className=\"chain\">Contract: {finalConfig.xpaExchange}</span> */}\n                    </h1>\n                    {/* <div className=\"controls\">\n                        <a\n                            href={guide()}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            <i className=\"fa fa-bookmark-o\" aria-hidden=\"true\" style={{ fontSize: '16px', paddingBottom: '3px' }} />\n                            <span>{t('header.guide')}</span>\n                        </a>\n                    </div>\n\n                    {!production ?\n                        <div className=\"controls\">\n                            <Link to=\"mortgage\">\n                                <i className=\"fa fa-university\" />\n                                <span>{t('header.mortgage')}</span>\n                            </Link>\n                        </div> : ''}\n                    <Language changeHeader={this.changeHeader} /> */}\n                    {this.props.dash ? this.renderSummary() : null }\n                    <div className=\"empty\" />\n                    {this.props.dash ? this.renderContract() : null }\n                    <div className=\"menu\" onClick={() => { this.setState(update(this.state, { showMenu: { $set: true }, showList: { $set: false } })); }}>\n                        <span />\n                        <span />\n                        <span />\n                    </div>\n                    <div className={this.state.showMenu ? 'cover show' : 'cover'} onClick={() => { this.setState(update(this.state, { showMenu: { $set: false } })); }} />\n                    <div className={this.state.showMenu ? 'control show' : 'control'}>\n                        <div className=\"group\">\n                            {this.renderMenu()}\n                        </div>\n                        <div className=\"group\">\n                            {this.renderLanguage()}\n                        </div>\n                        <div>\n                            <div>\n                                <a href={guide()} target=\"_blank\">{t('header.help')}</a>\n                            </div>\n                        </div>\n                        <div className=\"version\">\n                            <div>\n                                <a>v1.5.2</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </header>\n        );\n    }\n}\n\nHeader.defaultProps = {\n    t: () => {},\n    match: {},\n    from: {},\n    to: {},\n    dash: false,\n    tradeList: {},\n    tokenList: [],\n    actions: {},\n    select: () => {},\n    myTransaction: {}\n};\n\nHeader.propTypes = {\n    t: PropTypes.func,\n    match: PropTypes.object,\n    from: PropTypes.object,\n    to: PropTypes.object,\n    dash: PropTypes.bool,\n    tradeList: PropTypes.object,\n    tokenList: PropTypes.array,\n    actions: PropTypes.object,\n    select: PropTypes.func,\n    myTransaction: PropTypes.object,\n};\n\nexport default translate()(Header);\n","\n// limit number length smaller then l\nimport Web3 from 'web3';\n\nconst BN = Web3.utils.BN;\n\nfunction accMul(arg1, arg2)\n{\n    let m = 0;\n    const s1 = arg1.toString();\n    const s2 = arg2.toString();\n    try\n    {\n        m += s1.split('.')[1].length;\n    }\n    catch (e)\n    {}\n    try\n    {\n        m += s2.split('.')[1].length;\n    }\n    catch (e)\n    {}\n\n    return (Number(s1.replace('.', '')) * Number(s2.replace('.', ''))) / (10 ** m);\n}\n\nexport function formatNumber(l, num, max)\n{\n    const float = (`${num}`).split('.')[1];\n    const int = (`${num}`).split('.')[0];\n    const total = `${num}`.length - 1;\n    const maxFloatLen = max || 9;\n    if (!num) return num;\n    if (typeof num === 'string') num = Number(num);\n    try\n    {\n        if (total < l && (l - int.length) >= 0)\n        {\n            // const de = l - int.length;\n            const de = l;\n            return parseFloat((Math.floor(accMul(num, (10 ** de))) / (10 ** de)).toFixed(de));\n        }\n        else if (total < l && (l - total >= 0))\n        {\n            // const de = l - total;\n            const de = l;\n            return parseFloat((Math.floor(accMul(num, (10 ** de))) / (10 ** de)).toFixed(de));\n        }\n        else\n        {\n            if (total > l && !float)\n            {\n                return num.toFixed(0);\n            }\n            const de = l - int.length > 0 ? l - int.length : 0;\n            if (float && float.length >= maxFloatLen && float.length > l)\n            {\n                return parseFloat(num.toFixed(de));\n            }\n            return parseFloat((Math.floor(accMul(num, (10 ** de))) / (10 ** de)).toFixed(de));\n        }\n    }\n    catch (err)\n    {\n        console.warn(err);\n        return num;\n    }\n\n    // if (!num) return num;\n    // try\n    // {\n    //     return parseFloat((Math.floor(accMul(num, (10 ** l))) / (10 ** l)).toFixed(l));\n    // }\n    // catch (err)\n    // {\n    //     // console.warn(err);\n    //     return num;\n    // }\n}\n\nexport function formatTime(timestamp, type)\n{\n    const date = new Date(timestamp);\n    const d = [\n        date.getFullYear(),\n        date.getMonth() + 1,\n        date.getDate(),\n        date.getHours(),\n        date.getMinutes(),\n        date.getSeconds(),\n    ];\n    if (String(d[4]).length < 2)\n    {\n        d[4] = `0${d[4]}`;\n    }\n    if (String(d[5]).length < 2)\n    {\n        d[5] = `0${d[5]}`;\n    }\n\n    switch (type)\n    {\n        case 'time':\n            return `${d[3]}:${d[4]}:${d[5]}`;\n        case 'date':\n            return `${d[1]}-${d[2]} ${d[3]}:${d[4]}:${d[5]}`;\n        default:\n            return `${d[0]}-${d[1]}-${d[2]} ${d[3]}:${d[4]}:${d[5]}`;\n    }\n}\n\nconst isFloat = (n) =>\n{\n    return Number(n) === n && n % 1 !== 0;\n};\n\nexport function times(num1, num2)\n{\n    let dot1 = String(num1).split('.')[1];\n    let dot2 = String(num2).split('.')[1];\n    const Num1 = Number(num1);\n    const Num2 = Number(num2);\n\n    if (dot1)\n    {\n        dot1 = dot1.length <= 6 ? 6 : 10;\n    }\n    else\n    {\n        dot1 = 0;\n    }\n\n    if (dot2)\n    {\n        dot2 = dot2.length <= 6 ? 6 : 10;\n    }\n    else\n    {\n        dot2 = 0;\n    }\n\n    const fixedFloor = (num) => {\n        return parseFloat(num.toFixed(9));\n    };\n\n    if (isFloat(Num1) && isFloat(Num2))\n    {\n        return fixedFloor(((Num1 * (10 ** dot1)) * (Num2 * (10 ** dot2))) / ((10 ** dot1) * (10 ** dot2)));\n    }\n    else if (!isFloat(Num1) && isFloat(Num2))\n    {\n        return fixedFloor((Num1 * (Num2 * (10 ** dot2))) / (10 ** dot2));\n    }\n    else if (isFloat(Num1) && !isFloat(Num2))\n    {\n        return fixedFloor(((Num1 * (10 ** dot1)) * Num2) / (10 ** dot1));\n    }\n    else\n    {\n        return Num1 * Num2;\n    }\n}\n\n//  Scientific notation To String\nexport function scnToStr(x)\n{\n    if (Math.abs(x) < 1.0)\n    {\n        let e = parseInt(x.toString().split('e-')[1], 10);\n        if (e)\n        {\n            x *= (10 ** (e - 1));\n            x = `0.${(new Array(e)).join('0')}${x.toString().substring(2)}`;\n        }\n    }\n    else\n    {\n        let e = parseInt(x.toString().split('+')[1], 10);\n        if (e > 20)\n        {\n            e -= 20;\n            x /= (10 ** e);\n            x += (new Array(15)).join('0');\n        }\n    }\n    return String(x);\n}\n\nexport const subHex = (input) =>\n{\n    let index = 0;\n    if (!input || input.length < 1) return input;\n    let result = input.replace('0x', '');\n    for (let i = 0; i < result.length; i += 1)\n    {\n        if (result[i] === '0')\n        {\n            index = i + 1;\n        }\n        else\n        {\n            break;\n        }\n    }\n\n    result = result.substr(index, result.length);\n    return result ? result : '0';\n};\n\nexport const bnHex = (str) =>\n{\n    if (!str || str === '-') return new BN('0', 16);\n    return new BN(str, 16);\n};\n\nexport const bnTen = (str) =>\n{\n    if (!str || str === '-') return new BN('0', 10);\n    return new BN(str, 10);\n};\n\nexport const tenFill = (n, idx) =>\n{\n    if (typeof n === 'number')\n    {\n        n = n.toString();\n    }\n    const tmpArr = n.split('.');\n    const abs = Math.abs(idx);\n\n    if (tmpArr.length < 2)\n    {\n        tmpArr.push('');\n    }\n\n    const l1 = tmpArr[0].length;\n    const l2 = tmpArr[1].length;\n    if (idx > 0)\n    {\n        tmpArr[0] += tmpArr[1].substr(0, abs);\n        tmpArr[1] = tmpArr[1].substr(abs);\n        if (abs >= l2)\n        {\n            tmpArr[0] += new Array(abs - l2).fill(0).join('');\n        }\n    }\n    else if (idx < 0)\n    {\n        tmpArr[1] = tmpArr[0].substr(idx) + tmpArr[1];\n        tmpArr[0] = tmpArr[0].substr(0, tmpArr[0].length + idx);\n        if (abs >= l1)\n        {\n            tmpArr[1] = new Array(abs - l1).fill(0).join('') + tmpArr[1];\n        }\n    }\n\n    if (tmpArr[0].length === 0)\n    {\n        tmpArr[0] = '0';\n    }\n\n    let index;\n    for (index = tmpArr[1].length; index > 0; index -= 1)\n    {\n        if (tmpArr[1][index - 1] !== '0')\n        {\n            break;\n        }\n    }\n    tmpArr[1] = tmpArr[1].substr(0, index);\n    return tmpArr[1].length > 0 ? tmpArr.join('.') : tmpArr[0];\n};\n\nexport const sellAmount = (fAmount, fFill, fDecimal) =>\n{\n    return tenFill(bnHex(fAmount)\n        .sub(bnHex(fFill))\n        .toString(), -fDecimal);\n};\n\nexport const sellDisplayPrice = (price, fDecimal, tDecimal) =>\n{\n    return tenFill(bnHex(price).toString(), fDecimal - tDecimal - 18);\n};\n\nexport const buyAmount = (fAmount, fill, price, fDecimal) =>\n{\n    return tenFill(bnHex(fAmount)\n        .sub(bnHex(fill))\n        .mul(bnHex(price))\n        .toString(), -fDecimal - 18);\n};\n\nexport const buyDisplayPrice = (price, fDecimal, tDecimal) =>\n{\n    return tenFill(bnTen(tenFill(1, 36))\n        .div(bnHex(price))\n        .toString(), fDecimal - tDecimal - 18);\n};\n\n","export const CHANGE_MORTGAGE_RATE = 'CHANGE_MORTGAGE_RATE';\nexport const CHANGE_EQUIVALENT_AMOUNT = 'CHANGE_EQUIVALENT_AMOUNT';\nexport const CHANGE_USABLE = 'CHANGE_USABLE';\nexport const CHANGE_LOAN = 'CHANGE_LOAN';\nexport const CHANGE_REMAINING = 'CHANGE_REMAINING';\nexport const CHANGE_CLOSING_LINE = 'CHANGE_CLOSING_LINE';\nexport const MAPPING_ASSETS = 'MAPPING_ASSETS';\nexport const CHANGE_USABLE_XPA = 'CHANGE_USABLE_XPA';\nexport const MORTGAGE_LOGOUT = 'MORTGAGE_LOGOUT';\nexport const CHANGE_MORTGAGE_PRICE = 'CHANGE_MORTGAGE_PRICE';\n\n","/* eslint-disable no-undef */\nimport update from 'immutability-helper';\nimport * as types from '../constants/actionTypesBook';\n\nconst initialState = {\n    from: { token: 'XPA', address: finalConfig.XPA, decimal: 18 },\n    to: { token: 'ETH', address: finalConfig.ethAddress, decimal: 18 },\n    buy: [],\n    sell: [],\n    tokenList: [],\n    summary: {},\n    tradeList: {},\n    transaction: [],\n    kLine: [],\n    timeunit: 60 * 60 * 1000\n};\n\nexport default function book(state = initialState, action = {})\n{\n    switch (action.type)\n    {\n        case types.FROM_CHANGE:\n            return update(state, {\n                from: { $set: action.data }\n            });\n        case types.TO_CHANGE:\n            return update(state, {\n                to: { $set: action.data }\n            });\n        case types.BOOK_UPDATE:\n            return update(state, {\n                sell: { $set: action.data.sell },\n                buy: { $set: action.data.buy }\n            });\n        case types.TOKENLIST_GET:\n            return update(state, {\n                tokenList: { $set: action.data }\n            });\n        case types.SUMMARY_UPDATE:\n            return update(state, {\n                summary: { $set: action.data }\n            });\n        case types.TRADELIST_GET:\n            return update(state, {\n                tradeList: { $set: action.data }\n            });\n        // case types.ADD_TRADELIST:\n        //     return update(state, {\n        //         tradeList: {\n        //             star: { $set: [action.data] }\n        //         }\n        //     });\n        case types.RECENTTRANSACTION_UPDATE:\n            return update(state, {\n                transaction: { $set: action.data }\n            });\n        case types.KLINE_UPDATE:\n            return update(state, {\n                kLine: { $set: action.data }\n            });\n        case types.TIMEUINT_CHANGE:\n            return update(state, {\n                timeunit: { $set: action.data }\n            });\n        default:\n            return state;\n    }\n}\n","import update from 'immutability-helper';\nimport * as types from '../constants/actionTypesUser';\n\nconst initialState = {\n    user: {},\n    account: [],\n    myBooks: [],\n    myTransaction: {\n        price: '',\n        amount: '',\n        total: '-',\n        able: false,\n        act: 'buy'\n    },\n    keep: false,\n    myHistory: []\n};\n\nexport default function user(state = initialState, action = {})\n{\n    switch (action.type)\n    {\n        case types.USER_UPDATE:\n            return update(state, {\n                user: { $set: action.data }\n            });\n        case types.MYBOOKS_UPDATE:\n            return update(state, {\n                myBooks: { $set: action.data }\n            });\n        case types.MYBOOKS_ADD:\n            return update(state, {\n                myBooks: { $unshift: [action.data] }\n            });\n        case types.MYBOOKS_CANCEL:\n            return update(state, {\n                myBooks: {\n                    [action.data]: {\n                        status: { $set: 'cancel' }\n                    }\n                }\n            });\n        case types.MYBOOKS_CHANGE:\n            return update(state, {\n                myBooks: {\n                    [action.data]: {\n                        cancel: { $set: true }\n                    }\n                }\n            });\n        // case types.GET_BALANCE:\n        //     return update(state, {\n        //         account: {\n        //             [action.data.index]: {\n        //                 usable: { $set: action.data.value },\n        //             }\n        //         }\n        //     });\n        case types.MYTRANSACTION_CHANGE:\n            return update(state, {\n                myTransaction: {\n                    $set: action.data\n                }\n            });\n        case types.MYTRANSACTION_UPDATE:\n            return update(state, {\n                myTransaction: {\n                    [action.data.type]: { $set: action.data.value }\n                }\n            });\n        case types.ACCOUNT_UPDATE:\n            return update(state, {\n                account: { $set: action.data }\n            });\n        case types.KEEP:\n            return update(state, {\n                keep: { $set: true }\n            });\n\n        case types.DOWNLOADED:\n            return update(state, {\n                keep: { $set: false }\n            });\n        case types.HISTORY_UPDATE:\n            return update(state, {\n                myHistory: { $set: action.data }\n            });\n        default:\n            return state;\n    }\n}\n","import update from 'immutability-helper';\nimport * as types from '../constants/actionTypesModal';\n\nconst initialState = {\n    loading: false,\n    message: ''\n};\n\nexport default function modal(state = initialState, action = {})\n{\n    switch (action.type)\n    {\n        case types.UPDATE_LOADING:\n            return update(state, {\n                loading: { $set: action.data }\n            });\n        case types.UPDATE_MESSAGE:\n            return update(state, {\n                message: { $set: action.data }\n            });\n        default:\n            return state;\n    }\n}\n","import update from 'immutability-helper';\nimport * as types from '../constants/actionTypesNews';\n\nconst initialState = [];\n\nexport default function user(state = initialState, action = {})\n{\n    switch (action.type)\n    {\n        case types.SET_NEWS:\n            return update(state, { $set: action.data });\n\n        default:\n            return state;\n    }\n}\n","/* eslint-disable no-undef */\nimport update from 'immutability-helper';\nimport * as types from '../constants/actionTypeMortgage';\n\nconst cash = { ...finalConfig.assetToken };\nObject.keys(cash).forEach((k) =>\n{\n    cash[k] = 0;\n});\n\nconst initialState = {\n    mortgageRate: 0,\n    equivalentAmount: 0,\n    usable: { ...cash },\n    loan: { ...cash },\n    remaining: { ...cash },\n    price: { ...cash },\n    closingLine: 0,\n    usableXPA: 0\n};\n\nexport default function mortgage(state = initialState, action = {})\n{\n    switch (action.type)\n    {\n        case types.CHANGE_MORTGAGE_RATE:\n            return update(state, {\n                mortgageRate: { $set: action.data }\n            });\n        case types.CHANGE_EQUIVALENT_AMOUNT:\n            return update(state, {\n                equivalentAmount: { $set: action.data }\n            });\n        case types.CHANGE_USABLE:\n            return update(state, {\n                usable: { $set: action.data }\n            });\n        case types.CHANGE_LOAN:\n            return update(state, {\n                loan: { $set: action.data }\n            });\n        case types.CHANGE_REMAINING:\n            return update(state, {\n                remaining: { $set: action.data }\n            });\n        // case types.CHANGE_CLOSING_LINE:\n        //     return update(state, {\n        //         closingLine: { $set: action.data }\n        //     });\n        case types.CHANGE_USABLE_XPA:\n            return update(state, {\n                usableXPA: { $set: action.data }\n            });\n        case types.CHANGE_MORTGAGE_PRICE:\n            return update(state, {\n                price: { $set: action.data }\n            });\n        case types.MORTGAGE_LOGOUT:\n            return update(state, {\n                mortgageRate: { $set: '-' },\n                equivalentAmount: { $set: 0 },\n                usable: { $set: cash },\n                loan: { $set: cash },\n                remaining: { $set: cash },\n                closingLine: { $set: 0 },\n                usableXPA: { $set: 0 }\n            });\n        default:\n            return state;\n    }\n}\n\n","import { combineReducers } from 'redux';\nimport book from './book';\nimport user from './user';\nimport modal from './modal';\nimport news from './news';\nimport mortgage from './mortgage';\n\nconst rootReducer = combineReducers({\n    book,\n    user,\n    modal,\n    news,\n    mortgage\n});\n\nexport default rootReducer;\n","import { ofType } from 'redux-observable';\nimport { timeParse } from 'd3-time-format';\nimport { map, switchMap, mergeMap, catchError, concatMap } from 'rxjs/operators';\nimport { of, from as Rxfrom, merge } from 'rxjs';\nimport * as types from '../constants/actionTypesBook';\nimport { LOADING$ } from '../constants/actionTypesModal';\nimport {\n    bookUpdate,\n    recentTransactionUpdate,\n    summaryUpdate,\n    kLineGet$,\n    kLineUpdate\n} from '../actions/book';\nimport { updateLoading } from '../actions/modal';\nimport {\n    bnHex,\n    sellAmount,\n    buyAmount,\n    sellDisplayPrice,\n    buyDisplayPrice,\n    tenFill,\n    bnTen\n} from '../utils/format';\n\nimport OrderbookParser from '../utils/OrderbookParser';\n\nconst getBookEpic = (action$, state$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.BOOK_GET$),\n            switchMap(() =>\n            {\n                const { from, to } = state$.value.book;\n\n                return Rxfrom(OrderbookParser.getAll(from.address, to.address))\n            }),\n            concatMap((orders) => {\n                console.log('Send ', orders);\n                const { from, to, tokenList } = state$.value.book;\n\n                const fromToken = tokenList.find(tk => tk.address === from.address);\n                const toToken = tokenList.find(tk => tk.address === to.address);\n\n                const arrenge = (data) =>\n                {\n                    return data.sort((a, b) => (bnHex(a.price).gt(bnHex(b.price)) ? 1 : -1)) // \n                        .reduce((prev, curr) =>\n                        {\n                            // \n                            if (prev.length <= 0 || prev[prev.length - 1].price !== curr.price)\n                            {\n                                prev.push(curr);\n                            }\n                            else\n                            {\n                                prev[prev.length - 1].fromAmount = bnHex(prev[prev.length - 1].fromAmount).add(bnHex(curr.fromAmount)).toString(16);\n                                prev[prev.length - 1].filled = bnHex(prev[prev.length - 1].filled).add(bnHex(curr.filled)).toString(16);\n                            }\n\n                            return prev;\n                        }, [])\n                        .map((v) =>\n                        {\n                            let book;\n                            if (v.fromToken === from.address && v.toToken === to.address)\n                            {\n                                book = {\n                                    from: fromToken.token,\n                                    to: toToken.token,\n                                    desc: `${fromToken.token}/${toToken.token}`,\n                                    type: 'sell',\n                                    timestamp: v.timestamp,\n                                    price: v.price,\n                                    displayPrice: sellDisplayPrice(v.price, from.decimal, to.decimal),\n                                    amount: sellAmount(v.fromAmount, v.filled, from.decimal)\n                                };\n                            }\n                            else if (v.fromToken === to.address && v.toToken === from.address)\n                            {\n                                book = {\n                                    from: toToken.token,\n                                    to: fromToken.token,\n                                    desc: `${toToken.token}/${fromToken.token}`,\n                                    type: 'buy',\n                                    timestamp: v.timestamp,\n                                    price: v.price,\n                                    displayPrice: buyDisplayPrice(v.price, from.decimal, to.decimal),\n                                    amount: buyAmount(v.fromAmount, v.filled, v.price, from.decimal, to.decimal)\n                                };\n                            }\n                            book.value = Number(book.amount);\n                            book.displayPrice = Number(book.displayPrice);\n                            return book;\n                        })\n                        .filter(v => !!v);\n                };\n\n                let sell = orders.filter(d =>\n                    (d.fromToken === from.address && d.toToken === to.address) &&\n                    d !== undefined &&\n                    bnHex(d.fromAmount).sub(bnHex(d.filled)).gt(bnTen((10 ** (from.decimal - 6)).toString())));\n\n                let buy = orders.filter(d =>\n                    (d.fromToken === to.address && d.toToken === from.address) &&\n                    d !== undefined &&\n                    bnHex(d.fromAmount).sub(bnHex(d.filled)).gt(bnTen((10 ** (from.decimal - 6)).toString())));\n\n                sell = arrenge(sell).filter(d => d.type === 'sell')\n                    .map((d, i, all) =>\n                    {\n                        if (i === 0)\n                        {\n                            return d;\n                        }\n                        else\n                        {\n                            d.value += all[i - 1].value;\n                            return d;\n                        }\n                    });\n                sell.reverse();\n\n                buy = arrenge(buy).filter(d => d.type === 'buy')\n                    .map((d, i, all) =>\n                    {\n                        if (i === 0)\n                        {\n                            return d;\n                        }\n                        else\n                        {\n                            d.value += all[i - 1].value;\n                            return d;\n                        }\n                    });\n                return of({ buy, sell });\n            }),\n            // debounceTime(3000),\n            mergeMap(result => of(bookUpdate(result), updateLoading(false))),\n            catchError((err, obs) => {\n                console.error(err);\n                return concat(\n                    of(updateLoading(false)),\n                    obs\n                );\n            })\n        );\n};\n\nconst getTransactionEpic = (action$, state$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.RECENTTRANSACTION_GET$),\n            switchMap((action) =>\n            {\n                const { from, to, tokenList } = state$.value.book;\n\n                const fromToken = tokenList.find(tk => tk.address === from.address);\n                const toToken = tokenList.find(tk => tk.address === to.address);\n\n                const arr = Object.values(action.data || [])\n                    .map((v) =>\n                    {\n                        let list;\n                        if (v.fromToken === fromToken.address && v.toToken === toToken.address)\n                        {\n                            list = {\n                                timestamp: v.timestamp,\n                                price: v.price,\n                                displayPrice: sellDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: tenFill(bnHex(v.filled).toString(), -from.decimal),\n                                type: 'sell',\n                            };\n                        }\n                        else if (v.fromToken === toToken.address && v.toToken === fromToken.address)\n                        {\n                            list = {\n                                timestamp: v.timestamp,\n                                price: v.price,\n                                displayPrice: buyDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: tenFill(bnHex(v.filled)\n                                    .mul(bnHex(v.price))\n                                    .toString(), -(18 + from.decimal)),\n                                type: 'buy'\n                            };\n                        }\n                        return list;\n                    })\n                    .filter(v => !!v)\n                    .sort((a, b) => b.timestamp - a.timestamp);\n\n                return of(arr);\n            }),\n            mergeMap(result =>\n                of(\n                    recentTransactionUpdate(result.filter(v => new Date().getTime() - v.timestamp <= 86400 * 1000 * 30)),\n                    // summaryGet$(result),\n                    kLineGet$(result)\n                )),\n            catchError((err, obs) => obs)\n        );\n};\n\nconst getSummaryEpic = (action$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.SUMMARY_GET$),\n            map((action) =>\n            {\n                const now = new Date().getTime();\n                const final = action.data.filter(d => now - d.timestamp <= 86400 * 1000);\n                return summaryUpdate({\n                    latest: final[final.length - 1].price || 0,\n                    growth: final.length > 1 ? bnHex(final[final.length - 1].price).sub(bnHex(final[0].price)).div(bnHex(final[0].price)) : 0,\n                    max: final.reduce((prev, curr) =>\n                    {\n                        return bnHex(curr.price).gt(bnHex(prev)) ? curr.price : prev;\n                    }, 0),\n                    min: final.length > 0 ? final.reduce((prev, curr) =>\n                    {\n                        if (!prev || bnHex(curr.price).lt(bnHex(prev)))\n                        {\n                            return curr.price;\n                        }\n                        else\n                        {\n                            return prev;\n                        }\n                    }, '') : 0,\n                    amount: final.reduce((prev, curr) =>\n                    {\n                        return prev + (curr.amount);\n                    }, 0)\n                });\n            }),\n            catchError((err, obs) => obs)\n        );\n};\n\nconst getKLineEpic = (action$, state$) =>\n{\n    const parse = timeParse('%s');\n    return action$\n        .pipe(\n            ofType(types.KLINE_GET$),\n            switchMap((action) =>\n            {\n                if (action.data)\n                {\n                    return of(action.data.filter(d => d.type === 'sell'));\n                }\n                else\n                {\n                    return Rxfrom(window.dbObj.ref('priceBooks').once('value'))\n                        .pipe(\n                            map((snapshot) =>\n                            {\n                                const { from, to, tokenList } = state$.value.book;\n                                const fromToken = tokenList.find(tk => tk.address === from.address);\n                                const toToken = tokenList.find(tk => tk.address === to.address);\n                                const data = Object.values(snapshot.val() || [])\n                                    .map((v) =>\n                                    {\n                                        let list;\n                                        if (v.fromToken === fromToken.address && v.toToken === toToken.address)\n                                        {\n                                            list = {\n                                                timestamp: v.timestamp,\n                                                price: v.price,\n                                                displayPrice: sellDisplayPrice(v.price, fromToken.decimal, toToken.decimal),\n                                                amount: tenFill(bnHex(v.filled).toString(), -from.decimal),\n                                                type: 'sell',\n                                            };\n                                        }\n                                        // else if (v.fromToken === toToken.address && v.toToken === fromToken.address)\n                                        // {\n                                        //     list = {\n                                        //         timestamp: v.timestamp,\n                                        //         price: v.price,\n                                        //         displayPrice: buyDisplayPrice(v.price, toToken.decimal, fromToken.decimal),\n                                        //         amount: tenFill(bnHex(v.filled)\n                                        //             .mul(bnHex(v.price))\n                                        //             .toString(), -(from.decimal + 18)),\n                                        //         type: 'buy'\n                                        //     };\n                                        // }\n                                        return list;\n                                    })\n                                    .filter(v => !!v)\n                                    .sort((a, b) => b.timestamp - a.timestamp);\n                                return data;\n                            }),\n                            catchError((err, obs) =>\n                            {\n                                console.warn(err);\n                                return obs;\n                            })\n                        );\n                }\n            }),\n            map((data) =>\n            {\n                const dataLength = 120;\n                const timeunit = state$.value.book.timeunit;\n                const now = new Date().getTime();\n                const today = now - (now % timeunit);\n                const startday = today - (timeunit * (dataLength - 1));\n\n                const data5ma = new Array(dataLength).fill(0).map(() =>\n                {\n                    return { from: 0, to: 0 };\n                });\n                const data10ma = new Array(dataLength).fill(0).map(() =>\n                {\n                    return { from: 0, to: 0 };\n                });\n                const initialData = new Array(dataLength).fill(0).map((v, i) =>\n                {\n                    const d = {\n                        '5ma': 0,\n                        '10ma': 0,\n                        high: 0,\n                        low: 0,\n                        open: 0,\n                        close: 0,\n                        amount: 0,\n                        timestamp: startday + (timeunit * i)\n                    };\n                    return d;\n                });\n\n                const kLineData = data\n                    .filter(v => v.timestamp > startday)\n                    .reduce((prev, curr) =>\n                    {\n                        const rs = prev;\n                        const i = Math.floor((curr.timestamp - startday) / timeunit);\n                        const tmpFrom = Number(curr.amount);\n                        const tmpTo = Number(curr.amount) * curr.displayPrice;\n\n                        for (let j = 0; j < 5 && (i + j) < data5ma.length; j += 1)\n                        {\n                            data5ma[i + j].from += tmpFrom;\n                            data5ma[i + j].to += tmpTo;\n                        }\n\n                        for (let k = 0; k < 10 && (i + k) < data10ma.length; k += 1)\n                        {\n                            data10ma[i + k].from += tmpFrom;\n                            data10ma[i + k].to += tmpTo;\n                        }\n\n                        rs[i].low = rs[i].amount > 0 ? Math.min(rs[i].low, curr.displayPrice) : curr.displayPrice;\n                        rs[i].high = Math.max(rs[i].high, curr.displayPrice);\n                        rs[i].amount += Number(curr.amount);\n                        if (rs[i].open === 0)\n                        {\n                            rs[i].open = curr.displayPrice;\n                        }\n                        rs[i].close = curr.displayPrice;\n                        return rs;\n                    }, initialData)\n                    .map((v, i, arr) =>\n                    {\n                        const p = v;\n                        const previ = i - 1 >= 0 ? i - 1 : 0;\n                        p['5ma'] = (data5ma[i].to / data5ma[i].from) || arr[previ]['5ma'];\n                        p['10ma'] = (data10ma[i].to / data10ma[i].from) || arr[previ]['10ma'];\n                        p.timestamp = parse(p.timestamp / 1000);\n\n                        if (p.amount === 0 && i > 0)\n                        {\n                            p.high = arr[i - 1].close;\n                            p.low = arr[i - 1].close;\n                            p.open = arr[i - 1].close;\n                            p.close = arr[i - 1].close;\n                        }\n                        return p;\n                    });\n\n                return kLineUpdate(kLineData);\n            }),\n            catchError((err, obs) =>\n            {\n                console.warn(err);\n                return obs;\n            })\n        );\n};\n\n\n\nexport default [\n    getBookEpic,\n    getTransactionEpic,\n    getSummaryEpic,\n    getKLineEpic\n];\n","import { ofType } from 'redux-observable';\nimport { of } from 'rxjs';\nimport { switchMap, map, mergeMap, catchError } from 'rxjs/operators';\nimport * as types from '../constants/actionTypesUser';\nimport {\n    userUpdate,\n    accountGet$,\n    accountUpdate,\n    myBooksGet$,\n    myBooksUpdate,\n    historyUpdate\n} from '../actions/user';\nimport {\n    bnHex,\n    sellAmount,\n    buyAmount,\n    sellDisplayPrice,\n    buyDisplayPrice,\n    subHex,\n    bnTen,\n    tenFill\n} from '../utils/format';\nimport * as rpc from '../utils/rpc';\n\n// const getBalance = (address) => {\n\n// }\nconst userGetEpic = (action$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.USER_GET$),\n            mergeMap(action =>\n                of(\n                    userUpdate(action.data),\n                    accountGet$(),\n                    myBooksGet$()\n                ))\n        );\n};\n\nconst accountGetEpic = (action$, state$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.ACCOUNT_GET$),\n            // map((action) =>\n            // {\n            //     userUpdate(action.data);\n            // }),\n            // interval(15000),\n            switchMap(() =>\n            {\n                const { tokenList } = state$.value.book;\n                const { wallet } = state$.value.user.user;\n                return rpc.getUserBalance(tokenList, wallet.address);\n            }),\n            map((res) =>\n            {\n                const arr = [];\n                const { tokenList } = state$.value.book;\n\n                res.forEach((r, i) =>\n                {\n                    // actions.userActions.getBalance(i, balance);\n                    arr.push({\n                        token: tokenList[i].token,\n                        usable: r,\n                        address: tokenList[i].address\n                    });\n                });\n                return accountUpdate(arr);\n            })\n        );\n};\n\nconst myBooksGetEpic = (action$, state$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.MYBOOKS_GET$),\n            switchMap((action) =>\n            {\n                if (!action.data)\n                {\n                    return window.dbObj\n                        .ref('orderBooks')\n                        .orderByChild('user')\n                        .equalTo(`0x${state$.value.user.user.wallet.address}`)\n                        .once('value');\n                }\n                else\n                {\n                    return of(action.data);\n                }\n            }),\n            map((snapshot) =>\n            {\n                const { from, to, tokenList } = state$.value.book;\n                const { user } = state$.value.user;\n                const fromToken = tokenList.find(tk => tk.address === from.address);\n                const toToken = tokenList.find(tk => tk.address === to.address);\n                const data = Object.values(snapshot.val())\n                    .filter(d => d.user === `0x${user.wallet.address}`)\n                    .filter(d => (\n                        (d.fromToken === from.address && d.toToken === to.address) ||\n                        (d.fromToken === to.address && d.toToken === from.address)) &&\n                        d !== undefined &&\n                        bnHex(d.fromAmount).sub(bnHex(d.filled)).gt(bnTen((10 ** (from.decimal - 6)).toString()))\n                    )\n                    .sort((a, b) => (bnHex(a.price).toString() > bnHex(b.price).toString() ? 1 : -1)) // \n                    .sort((a, b) => (a.fromToken > b.fromToken ? 1 : -1)) // \n                    // .reduce((prev, curr) =>\n                    // {\n                    //     // \n                    //     if (prev.length <= 0 || prev[prev.length - 1].price !== curr.price)\n                    //     {\n                    //         prev.push(curr);\n                    //     }\n                    //     else\n                    //     {\n                    //         prev[prev.length - 1].fromAmount = bnHex(prev[prev.length - 1].fromAmount).add(bnHex(curr.fromAmount)).toString(16);\n                    //         prev[prev.length - 1].filled = bnHex(prev[prev.length - 1].filled).add(bnHex(curr.filled)).toString(16);\n                    //     }\n\n                    //     return prev;\n                    // }, [])\n                    .map((v) =>\n                    {\n                        let book;\n                        if (v.fromToken === from.address && v.toToken === to.address)\n                        {\n                            book = {\n                                from: fromToken.token,\n                                to: toToken.token,\n                                desc: `${fromToken.token}/${toToken.token}`,\n                                type: 'sell',\n                                timestamp: v.timestamp,\n                                price: v.price,\n                                displayPrice: sellDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: v.fromAmount,\n                                displayAmount: tenFill(bnHex(v.fromAmount).toString(), -fromToken.decimal),\n                                fill: v.filled\n                            };\n                        }\n                        else if (v.fromToken === to.address && v.toToken === from.address)\n                        {\n                            book = {\n                                from: toToken.token,\n                                to: fromToken.token,\n                                desc: `${fromToken.token}/${toToken.token}`,\n                                type: 'buy',\n                                timestamp: v.timestamp,\n                                price: v.price,\n                                displayPrice: buyDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: v.fromAmount,\n                                displayAmount: tenFill(bnHex(v.fromAmount).mul(bnHex(v.price)).toString(), -from.decimal - 18),\n                                fill: bnHex(v.filled).mul(bnHex(v.price)).div(bnTen((10 ** 18).toString())).toString(16)\n                            };\n                        }\n                        book.value = Number(book.amount);\n                        return book;\n                    })\n                    .filter(v => !!v)\n                    .sort((a, b) => b.timestamp - a.timestamp);\n\n                data.forEach((d, i) =>\n                {\n                    d.no = i;\n                    d.cancel = false;\n                });\n\n                return myBooksUpdate(data);\n            }),\n            catchError((err, obs) => obs)\n        );\n};\n\nconst historyGetEpic = (action$, state$) =>\n{\n    return action$\n        .pipe(\n            ofType(types.HISTORY_GET$),\n            map((action) =>\n            {\n                const { from, to, tokenList } = state$.value.book;\n                const fromToken = tokenList.find(v => v.address === from.address);\n                const toToken = tokenList.find(v => v.address === to.address);\n                const data = Object.values(action.data)\n                    .filter(v => (v.fromToken === from.address && v.toToken === to.address) || (v.fromToken === to.address && v.toToken === from.address))\n                    .sort((a, b) => (a.timestamp < b.timestamp ? 1 : -1))\n                    .filter(v => v.type !== 'take')\n                    .map((v) =>\n                    {\n                        let book;\n                        if (v.fromToken === from.address && v.toToken === to.address)\n                        {\n                            book = {\n                                no: v.no,\n                                from: fromToken.token,\n                                to: toToken.token,\n                                desc: `${fromToken.token}/${toToken.token}`,\n                                price: v.price,\n                                displayPrice: sellDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: sellAmount(v.fromAmount, v.filled, fromToken.decimal),\n                                type: v.type,\n                                timestamp: v.timestamp\n                            };\n                            if (v.type === 'cancel')\n                            {\n                                book.type = 'csell';\n                            }\n                            else if (v.type === 'trade')\n                            {\n                                book.type = 'tsell';\n                            }\n                        }\n                        else if (v.fromToken === to.address && v.toToken === from.address)\n                        {\n                            book = {\n                                no: v.no,\n                                from: toToken.token,\n                                to: fromToken.token,\n                                desc: `${fromToken.token}/${toToken.token}`,\n                                price: v.price,\n                                displayPrice: buyDisplayPrice(v.price, from.decimal, to.decimal),\n                                amount: buyAmount(v.fromAmount, v.filled, v.price, from.decimal, to.decimal),\n                                type: v.type,\n                                timestamp: v.timestamp\n                            };\n                            if (book.type === 'cancel')\n                            {\n                                book.type = 'cbuy';\n                            }\n                            else if (book.type === 'trade')\n                            {\n                                book.type = 'tbuy';\n                            }\n                        }\n                        return book;\n                    })\n                    .filter(v => !!v);\n\n                return historyUpdate(data);\n            }),\n            catchError((err, obs) =>\n            {\n                console.warn(err);\n                return obs;\n            })\n        );\n};\n\nexport default [\n    userGetEpic,\n    accountGetEpic,\n    myBooksGetEpic,\n    historyGetEpic\n];\n","import { combineEpics } from 'redux-observable';\nimport booksEpic from './book';\nimport userEpic from './user';\n\nconst rootEpic = combineEpics(\n    ...booksEpic,\n    ...userEpic\n);\n\nexport default rootEpic;\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport { createEpicMiddleware } from 'redux-observable';\nimport rootReducer from '../reducers';\nimport rootEpic from '../epics';\n\nconst epicMiddleware = createEpicMiddleware();\nexport default function configureStore(middleware, initialState)\n{\n    const store = createStore(\n        rootReducer,\n        initialState,\n        compose(\n            applyMiddleware(thunk, middleware, epicMiddleware),\n            window.devToolsExtension ? window.devToolsExtension() : f => f\n        )\n    );\n\n    epicMiddleware.run(rootEpic);\n\n    return store;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Header from '../header/header';\nimport './main.scss';\n\nclass Main extends React.Component\n{\n    static contextTypes = {\n        router: PropTypes.object.isRequired\n    }\n    constructor(props, context)\n    {\n        super(props, context);\n        this.state = {};\n    }\n\n    render()\n    {\n        return (\n            <div>\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nMain.propTypes = {\n    children: PropTypes.object.isRequired\n};\n\nexport default Main;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport { parse } from 'qs';\n\nexport default function asyncComponent(getComponent)\n{\n    return class AsyncComponent extends React.Component\n    {\n        static propTypes = {\n            location: PropTypes.object.isRequired\n        }\n\n        static Component = null;\n\n        constructor(props, context)\n        {\n            super(props, context);\n            this.mounted = false;\n            this.state = {\n                Component: AsyncComponent.Component\n            };\n        }\n\n        componentWillMount()\n        {\n            if (!this.state.Component)\n            {\n                getComponent().then((Component) =>\n                {\n                    AsyncComponent.Component = Component;\n                    if (this.mounted)\n                    {\n                        this.setState(update(this.state, {\n                            Component: { $set: Component }\n                        }));\n                    }\n                });\n            }\n        }\n\n        componentDidMount()\n        {\n            this.mounted = true;\n        }\n\n        componentWillUnmount()\n        {\n            this.mounted = false;\n        }\n\n        render()\n        {\n            const props = update(this.props, {\n                location: {\n                    query: { $set: parse(this.props.location.search.replace('?', '')) }\n                }\n            });\n\n            const { Component } = this.state;\n            if (Component)\n            {\n                return <Component {...props} />;\n            }\n            else\n            {\n                return null;\n            }\n        }\n    };\n}\n","import React from 'react';\n\nimport createRoutes from './routes/routes';\n// routes\nconst routes = createRoutes();\n\nfunction App() {\n  return routes;\n}\n\nexport default App;\n","import React from 'react';\nimport { HashRouter, Switch, Route, Redirect } from 'react-router-dom';\nimport Main from '../components/main/main';\nimport asyncComponent from '../utils/asyncComponent';\n\nexport default function createRoutes()\n{\n    return (\n        <HashRouter>\n            <Main>\n                <Switch>\n                    <Route exact path=\"/\" component={asyncComponent(() => import('../containers/landingPage/landingPage').then(module => module.default))} />\n                    <Route exact path=\"/order\" component={asyncComponent(() => import('../containers/order/order').then(module => module.default))} />\n                    <Route exact path=\"/exchange\" component={asyncComponent(() => import('../containers/index/index').then(module => module.default))} />\n                    <Route exact path=\"/mortgage\" component={asyncComponent(() => import('../containers/mortgage/mortgage').then(module => module.default))} />\n                    <Route exact path=\"/offset\" component={asyncComponent(() => import('../containers/offset/offset').then(module => module.default))} />\n                    <Route exact path=\"/privacy\" component={asyncComponent(() => import('../containers/privacy/privacy').then(module => module.default))} />\n                    <Route exact path=\"/currency\" component={asyncComponent(() => import('../containers/currency/currency').then(module => module.default))} />\n                    {/* <Route exact path=\"/help\" component={asyncComponent(() => import('../containers/help/help').then(module => module.default))} /> */}\n                    <Route exact nomatch render={() => <Redirect to=\"/exchange\" />} />\n                </Switch>\n            </Main>\n        </HashRouter>\n    );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { createBrowserHistory } from 'history'\nimport { Provider } from 'react-redux';\nimport { ConnectedRouter, routerMiddleware } from 'react-router-redux';\nimport { I18nextProvider } from 'react-i18next';\nimport configureStore from './store/configureStore';\nimport i18n from './i18n/i18n';\n\nimport App from './App';\n// // react-router-redux\nconst history = createBrowserHistory();\nconst middleware = routerMiddleware(history);\n\n// store\nconst store = configureStore(middleware);\n\n\n\nconsole.log('Version: 1.5.4');\n\n\n\nReactDOM.render(\n\n    <Provider store={store}>\n        <I18nextProvider i18n={i18n}>\n            <App />\n        </I18nextProvider>\n    </Provider>,\n\n    document.getElementById('root'),\n);\n","import * as types from '../constants/actionTypesUser';\n\nexport function userGet$(data)\n{\n    return {\n        type: types.USER_GET$,\n        data\n    };\n}\n\nexport function userUpdate(data)\n{\n    return {\n        type: types.USER_UPDATE,\n        data\n    };\n}\n\nexport function myBooksGet$(data)\n{\n    return {\n        type: types.MYBOOKS_GET$,\n        data\n    };\n}\n\nexport function myBooksUpdate(data)\n{\n    return {\n        type: types.MYBOOKS_UPDATE,\n        data\n    };\n}\n\nexport function myBooksAdd(data)\n{\n    return {\n        type: types.MYBOOKS_ADD,\n        data\n    };\n}\n\nexport function myBooksCancel(data)\n{\n    return {\n        type: types.MYBOOKS_CANCEL,\n        data\n    };\n}\n\nexport function myBooksChange(data)\n{\n    return {\n        type: types.MYBOOKS_CHANGE,\n        data\n    };\n}\n\nexport function myTransactionChange(data)\n{\n    return {\n        type: types.MYTRANSACTION_CHANGE,\n        data\n    };\n}\n\nexport function myTransactionUpdate(data)\n{\n    return {\n        type: types.MYTRANSACTION_UPDATE,\n        data\n    };\n}\n\nexport function accountGet$()\n{\n    return {\n        type: types.ACCOUNT_GET$,\n    };\n}\n\nexport function accountUpdate(data)\n{\n    return {\n        type: types.ACCOUNT_UPDATE,\n        data\n    };\n}\n\nexport function historyGet$(data)\n{\n    return {\n        type: types.HISTORY_GET$,\n        data\n    };\n}\n\nexport function historyUpdate(data)\n{\n    return {\n        type: types.HISTORY_UPDATE,\n        data\n    };\n}\n\n// export function getBalance(index, value)\n// {\n//     const data = { index, value };\n//     return {\n//         type: types.GET_BALANCE,\n//         data\n//     };\n// }\n\nexport function changeKeep(data)\n{\n    if (data)\n    {\n        return {\n            type: types.KEEP,\n            data\n        };\n    }\n    else\n    {\n        return {\n            type: types.DOWNLOADED,\n            data\n        };\n    }\n}\n","export const UPDATE_LOADING = 'UPDATE_LOADING';\nexport const UPDATE_MESSAGE = 'UPDATE_MESSAGE';\n","import * as types from '../constants/actionTypesBook';\n\n// \b from\nexport function changeFrom(data)\n{\n    return {\n        type: types.FROM_CHANGE,\n        data\n    };\n}\n\n// \b from\nexport function changeTo(data)\n{\n    return {\n        type: types.TO_CHANGE,\n        data\n    };\n}\n\n//  epic \nexport const bookGet$ = (data) =>\n{\n    return {\n        type: types.BOOK_GET$,\n        data\n    };\n};\n\n// \b\nexport function bookUpdate(data)\n{\n    return {\n        type: types.BOOK_UPDATE,\n        data\n    };\n}\n\n// \b tokenList\nexport function tokenListGet(data)\n{\n    return {\n        type: types.TOKENLIST_GET,\n        data\n    };\n}\n\n//  epic \nexport function summaryGet$(data)\n{\n    return {\n        type: types.SUMMARY_GET$,\n        data\n    };\n}\n\nexport function summaryUpdate(data)\n{\n    return {\n        type: types.SUMMARY_UPDATE,\n        data\n    };\n}\n\nexport function tradeListGet(data)\n{\n    return {\n        type: types.TRADELIST_GET,\n        data\n    };\n}\n\n// export function addTradeList(data)\n// {\n//     return {\n//         type: types.ADD_TRADELIST,\n//         data\n//     };\n// }\n\nexport function recentTransactionGet$(data)\n{\n    return {\n        type: types.RECENTTRANSACTION_GET$,\n        data\n    };\n}\n\nexport function recentTransactionUpdate(data)\n{\n    return {\n        type: types.RECENTTRANSACTION_UPDATE,\n        data\n    };\n}\n\nexport function kLineGet$(data)\n{\n    return {\n        type: types.KLINE_GET$,\n        data\n    };\n}\n\nexport function kLineUpdate(data)\n{\n    return {\n        type: types.KLINE_UPDATE,\n        data\n    };\n}\n\nexport function timeunitChange(data)\n{\n    return {\n        type: types.TIMEUINT_CHANGE,\n        data\n    };\n}\n"],"sourceRoot":""}